{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"SuperApp Mobile - Guide","text":""},{"location":"#project-summary","title":"Project Summary","text":"<p>The SuperApp Mobile is an open-source unified platform powered by micro app architecture, enabling seamless integration of multiple web applications within a single container. This project serves as the foundation for hosting multiple micro-apps with centralized authentication, integration, and management capabilities.</p> <p>The platform consists of three main components: a React Native mobile application (built with Expo) that serves as the container for micro-apps, Go-based backend services providing API and authentication capabilities, and a React-based admin portal for managing micro-apps. The system supports dynamic micro-app loading, IDP based user management, push notifications via Firebase, and comprehensive observability through OpenTelemetry.</p> <p></p>"},{"location":"#getting-started","title":"Getting Started","text":"<p>Ready to dive in? Head over to our Getting Started Guide to choose your path and begin your journey with the SuperApp platform.</p> <p> Get Started Now</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Micro App Architecture: Load and run multiple web applications within a single mobile container</li> <li>User Authentication: OAuth2.0 OIDC based user authentication</li> <li>Secure Microapp Communication: Token service for microapps to securely communicate with their backend</li> <li>Push Notifications: Firebase Cloud Messaging integration for targeted notifications</li> <li>Admin Portal: Web-based management interface for uploading and configuring micro-apps</li> <li>Observability: OpenTelemetry metrics collection with Prometheus integration</li> <li>Extensible Framework: Allows customization of data storage and user management via a pluggable architecture. Standards based and no vendor lock-in</li> </ul>"},{"location":"#key-concepts","title":"Key Concepts","text":""},{"location":"#superapp-vs-microapps","title":"SuperApp vs MicroApps","text":"<ul> <li>SuperApp: The main container application that manages authentication, navigation, and micro-app lifecycle</li> <li>MicroApps: Individual web applications loaded in WebViews, each serving specific functionality</li> <li>Bridge: Communication layer between SuperApp and MicroApps </li> </ul>"},{"location":"#how-micro-apps-work","title":"How Micro-Apps Work","text":"<ol> <li>Micro-apps are listed in the Super App Store.</li> <li>Users can download micro-apps from the store.</li> <li>Downloaded micro-apps are stored locally.</li> <li>When launched, the micro-app receives micro-app\u2013specific access tokens from the superapp, which it uses to securely communicate with the respective backends.</li> </ol>"},{"location":"#technology-stack","title":"Technology Stack","text":"Component Technologies Mobile App React Native, Expo, Redux Toolkit, TypeScript Backend Services Go 1.25.4, Chi Router, GORM, MySQL 8.0+ Authentication JWT (RS256), OAuth2, OIDC Notifications Firebase Admin SDK, FCM Admin Portal React, Vite, TypeScript Observability OpenTelemetry, Prometheus, Grafana"},{"location":"#support-contributing","title":"Support &amp; Contributing","text":"<ul> <li>Issues: GitHub Issues</li> <li>License: Apache 2.0</li> <li>Contributing: Check out the latest development version on the main branch. </li> </ul>"},{"location":"FUTURE_IMPROVEMENTS/","title":"FUTURE IMPROVEMENTS","text":""},{"location":"FUTURE_IMPROVEMENTS/#overview","title":"Overview","text":"<p>This document outlines proposed future improvements for the SuperApp Mobile project.</p>"},{"location":"FUTURE_IMPROVEMENTS/#planned-features","title":"Planned Features","text":"<ul> <li>Enable user onboarding via API and Super App Portal</li> </ul>"},{"location":"FUTURE_IMPROVEMENTS/#uiux-improvements","title":"UI/UX Improvements","text":"<ul> <li>Implement multi-language support (For Mobile Appliction)</li> </ul>"},{"location":"FUTURE_IMPROVEMENTS/#testing-quality-assurance","title":"Testing &amp; Quality Assurance","text":"<ul> <li>Integrate automated testing frameworks</li> <li>Define manual testing strategies</li> <li>Add runtime debug log support</li> </ul>"},{"location":"admin/portal-guide/","title":"Admin Portal Guide","text":"<p>Complete guide for SuperApp administrators to manage users, micro-apps, and system configuration.</p>"},{"location":"admin/portal-guide/#overview","title":"Overview","text":"<p>The SuperApp Admin Portal is a web-based interface for managing the SuperApp platform. As an administrator, you can:</p> <ul> <li>Manage MicroApps: Create, upload, version, and configure micro-apps</li> <li>Manage Users: Create and manage user accounts</li> <li>Create OAuth Clients: Generate credentials for microapp backends (Coming Soon)</li> </ul> <p>Note</p> <p>OAuth client creation is required only for microapps that need to send push notifications.</p>"},{"location":"admin/portal-guide/#accessing-the-admin-portal","title":"Accessing the Admin Portal","text":""},{"location":"admin/portal-guide/#login","title":"Login","text":"<ol> <li>Navigate to the admin portal URL</li> <li>Click \"Sign In\"</li> <li>Authenticate using your admin credentials</li> <li>You'll be redirected to the admin dashboard</li> </ol>"},{"location":"admin/portal-guide/#managing-microapps","title":"Managing MicroApps","text":""},{"location":"admin/portal-guide/#creating-a-new-microapp","title":"Creating a New MicroApp","text":"<ol> <li> <p>Navigate to MicroApps</p> <ul> <li>Click \"MicroApps\" in the sidebar</li> <li>Click \"+ New MicroApp\" button</li> </ul> </li> <li> <p>Fill in Basic Information</p> <ul> <li>App ID: unique-app-id (e.g., \"news-reader\")</li> <li>Name: Display name (e.g., \"News Reader\")</li> <li>Description: Brief description of the app</li> <li>Promo Text: (optional) Marketing text for app store</li> </ul> </li> <li> <p>Upload Assets</p> <ul> <li>Icon: Square image (512x512px recommended)</li> <li>Banner: (optional) Wide image (1920x1080px recommended)</li> </ul> </li> <li> <p>Version Details</p> <ul> <li>Version: Initial version (e.g., \"1.0.0\")</li> <li>Build Number: Internal build number (auto-incremented)</li> <li>Release Notes: Description of changes in this version</li> <li>App Package: Upload the ZIP file of the built microapp</li> </ul> </li> <li> <p>Roles &amp; Capabilities</p> <ul> <li>Roles/Groups: Assign roles/groups required to access this microapp (use + to add multiple)</li> <li>Capabilities: Specify which bridge functions this micro-app can access (use + to add multiple)</li> </ul> </li> <li> <p>Review and Click \"Create Micro App\"</p> </li> </ol>"},{"location":"admin/portal-guide/#adding-a-version","title":"Adding a Version","text":"<p>In Micro Apps Dashboard:</p> <ol> <li>Click on three dots in right below corner of the MicroApp card in the list</li> <li>Click \"Add New Version\"</li> <li>Fill in Version Details <pre><code>Version: 1.0.1 (semantic versioning)\nBuild Number: (auto incremented)\nRelease Notes: Description of changes\nApp Package: Upload new ZIP file\n</code></pre></li> <li>Click \"Add Version\"</li> </ol>"},{"location":"admin/portal-guide/#updating-a-microapp","title":"Updating a MicroApp","text":"<p>In Micro Apps Dashboard:</p> <ol> <li>Click on three dots in right below corner of the MicroApp card in the list</li> <li>Click \"Edit Information\"</li> <li>Update fields as needed</li> <li>Click \"Update\"</li> </ol>"},{"location":"admin/portal-guide/#deactivating-a-microapp","title":"Deactivating a MicroApp","text":"<p>In Micro Apps Dashboard:</p> <ol> <li>Click on three dots in right below corner of the MicroApp card in the list</li> <li>Click \"Delete\"</li> <li>Confirm the action</li> <li>The microapp will no longer appear in the mobile app store</li> </ol>"},{"location":"admin/portal-guide/#creating-oauth-clients-for-microapps","title":"Creating OAuth Clients for MicroApps","text":"<p>Warning</p> <p>This feature under development. OAuth client creation will be available in future releases.</p>"},{"location":"admin/portal-guide/#step-1-create-oauth-client","title":"Step 1: Create OAuth Client","text":"<p>...</p> <p>\u26a0\ufe0f Critical: The <code>client_secret</code> is only shown once. Save it immediately!</p>"},{"location":"admin/portal-guide/#step-2-store-credentials-securely","title":"Step 2: Store Credentials Securely","text":"<p>...</p>"},{"location":"admin/portal-guide/#step-3-provide-to-microapp-developer","title":"Step 3: Provide to MicroApp Developer","text":"<p>Send the credentials to the microapp backend developer:</p> <pre><code>Client ID: microapp-news\nClient Secret: aB3dE5fG7hI9jK1lM3nO5pQ7rS9tU1vW\nToken Endpoint: https://api.superapp.com/oauth/token\n</code></pre> <p>The developer will use these to authenticate their backend with the SuperApp API.</p>"},{"location":"admin/portal-guide/#available-scopes","title":"Available Scopes","text":"Scope Description <code>notifications:send</code> Send push notifications to users"},{"location":"admin/portal-guide/#managing-users","title":"Managing Users","text":""},{"location":"admin/portal-guide/#creating-a-user","title":"Creating a User","text":"<p>The SuperApp maintains a local user database to store additional user profile information (like location, thumbnail, preferences) that may not be available from your External IdP. This allows the platform to enrich user profiles and provide a better user experience across microapps.</p> <ol> <li> <p>Navigate to Users</p> <ul> <li>Click \"Users\" in the sidebar</li> <li>Click \"+ Add User\" button</li> </ul> </li> <li> <p>Fill in User Details</p> <ul> <li>Email: user@example.com</li> <li>First Name: John</li> <li>Last Name: Doe</li> <li>Location: New York, USA (optional)</li> <li>User Thumbnail: Profile picture URL (optional)</li> </ul> </li> <li> <p>Click \"Create User\"</p> </li> </ol> <p>Note</p> <p>Users must also be created in your External IdP for authentication. The SuperApp database stores additional profile information only.</p>"},{"location":"admin/portal-guide/#bulk-user-import","title":"Bulk User Import","text":"<ol> <li> <p>Navigate to Users</p> <ul> <li>Click \"Users\" in the sidebar</li> <li>Click \"+ Add Users\" button</li> </ul> </li> <li> <p>Click Bulk Add</p> </li> <li> <p>Upload CSV File</p> <ul> <li>Prepare a CSV file with columns: email, first_name, last_name, location, thumbnail_url</li> <li>Click \"Upload CSV/JSON\" and select your CSV/JSON</li> <li>Click \"Create\"</li> </ul> </li> </ol>"},{"location":"admin/portal-guide/#deleting-a-user","title":"Deleting a User","text":"<ol> <li>Navigate to the user</li> <li>Click \"Delete\"</li> <li>Confirm the action</li> </ol> <p>Note</p> <p>This only deletes the user from the SuperApp database, not from the External IdP.</p>"},{"location":"admin/portal-guide/#best-practices","title":"Best Practices","text":""},{"location":"admin/portal-guide/#microapp-management","title":"MicroApp Management","text":"<ul> <li>Use semantic versioning (1.0.0, 1.0.1, 1.1.0, 2.0.0)</li> <li>Test microapps thoroughly before marking as \"latest\"</li> <li>Keep old versions available for rollback</li> <li>Use descriptive names and clear descriptions</li> <li>Optimize images (compress icons and banners)</li> <li>Document configuration keys for developers</li> </ul>"},{"location":"admin/portal-guide/#oauth-client-management","title":"OAuth Client Management","text":"<ul> <li>Create separate clients for each microapp backend</li> <li>Use descriptive names (e.g., \"News Reader Backend\")</li> <li>Grant minimum required scopes (principle of least privilege)</li> <li>Rotate secrets periodically (every 90 days recommended)</li> <li>Store secrets in secure secret management systems</li> <li>Never commit secrets to version control</li> </ul>"},{"location":"admin/portal-guide/#user-management","title":"User Management","text":"<ul> <li>Use consistent naming conventions</li> <li>Verify email addresses</li> <li>Assign appropriate roles</li> <li>Remove inactive users regularly</li> <li>Keep IDP and SuperApp database in sync</li> </ul>"},{"location":"admin/portal-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"admin/portal-guide/#microapp-not-appearing-in-mobile-app","title":"MicroApp Not Appearing in Mobile App","text":"<p>Possible Causes: 1. MicroApp is deactivated 2. User doesn't have required role 3. Download URL is inaccessible</p> <p>Solutions: - Check microapp status (should be active) - Verify user has matching role - Test download URL in browser</p>"},{"location":"admin/portal-guide/#oauth-client-authentication-failing","title":"OAuth Client Authentication Failing","text":"<p>Possible Causes: 1. Wrong client ID or secret 2. Client is inactive 3. Token endpoint URL is incorrect</p> <p>Solutions: - Verify credentials match exactly - Check client status in database - Confirm token endpoint</p>"},{"location":"admin/portal-guide/#user-cant-log-in","title":"User Can't Log In","text":"<p>Possible Causes: 1. User doesn't exist in IDP 2. Wrong credentials 3. User is disabled</p> <p>Solutions: - Verify user exists in External IDP and SuperApp database - Check user status (should be enabled) - Reset password if needed - Check IDP logs for errors</p>"},{"location":"admin/portal-guide/#next-steps","title":"Next Steps","text":"<ul> <li>API Reference - Complete API documentation</li> </ul>"},{"location":"api/reference/","title":"API Reference","text":"<p>Complete reference for all API endpoints in the OpenSuperApp SuperApp Mobile platform.</p>"},{"location":"api/reference/#base-urls","title":"Base URLs","text":"Service Base URL Purpose Core Service <code>http://localhost:9090</code> Main API Token Service <code>http://localhost:8081</code> Authentication"},{"location":"api/reference/#api-overview","title":"API Overview","text":""},{"location":"api/reference/#core-service-endpoints","title":"Core Service Endpoints","text":"Method Endpoint Description Auth Details User Management GET <code>/api/v1/users/me</code> Get current user info User \u2193 GET <code>/api/v1/users</code> Get all users User \u2193 POST <code>/api/v1/users</code> Create/update user User \u2193 DELETE <code>/api/v1/users/{email}</code> Delete user User \u2193 MicroApp Management GET <code>/api/v1/microapps</code> Get all MicroApps User \u2193 GET <code>/api/v1/microapps/{id}</code> Get MicroApp by ID User \u2193 POST <code>/api/v1/microapps</code> Create/update MicroApp User \u2193 DELETE <code>/api/v1/microapps/{id}</code> Deactivate MicroApp User \u2193 User Configuration GET <code>/api/v1/user-config</code> Get user configuration User \u2193 POST <code>/api/v1/user-config</code> Update user configuration User \u2193 Push Notifications POST <code>/api/v1/notifications/register</code> Register device token User \u2193 POST <code>/api/v1/services/notifications/send</code> Send push notification Service \u2193 Token Exchange POST <code>/api/v1/oauth/exchange</code> Exchange user token for MicroApp token User \u2193 GET <code>/api/v1/.well-known/jwks.json</code> Get JWKS (public keys) Public \u2193 File Management POST <code>/api/v1/files</code> Upload file User \u2193 DELETE <code>/api/v1/files</code> Delete file User \u2193 GET <code>/api/v1/public/micro-app-files/download/{fileName}</code> Download file Public \u2193"},{"location":"api/reference/#token-service-endpoints","title":"Token Service Endpoints","text":"Method Endpoint Description Auth Details POST <code>/oauth/token</code> Get service token (Client Credentials) Basic Auth \u2193 POST <code>/oauth/clients</code> Create OAuth client None \u2193 POST <code>/oauth/token/user</code> Get user context token None \u2193 GET <code>/.well-known/jwks.json</code> Get JWKS Public \u2193"},{"location":"api/reference/#core-service-api","title":"Core Service API","text":""},{"location":"api/reference/#authentication","title":"Authentication","text":"<p>All user-authenticated endpoints require an <code>Authorization</code> header:</p> <pre><code>Authorization: Bearer &lt;External_IdP_user_token&gt;\n</code></pre> <p>Service-authenticated endpoints require a service token:</p> <pre><code>Authorization: Bearer &lt;service_token&gt;\n</code></pre>"},{"location":"api/reference/#user-management","title":"User Management","text":""},{"location":"api/reference/#get-current-user-info","title":"Get Current User Info","text":"<p>Retrieves the authenticated user's profile information.</p> <p>Endpoint: <code>GET /api/v1/users/me</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Response (200 OK): <pre><code>{\n  \"email\": \"user@example.com\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\",\n  \"userThumbnail\": \"https://example.com/avatar.jpg\",\n  \"location\": \"New York, USA\"\n}\n</code></pre></p>"},{"location":"api/reference/#get-all-users","title":"Get All Users","text":"<p>Retrieves all users in the system (admin function).</p> <p>Endpoint: <code>GET /api/v1/users</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Response (200 OK): <pre><code>[\n  {\n    \"email\": \"user1@example.com\",\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"userThumbnail\": \"https://example.com/avatar1.jpg\",\n    \"location\": \"New York, USA\"\n  },\n  {\n    \"email\": \"user2@example.com\",\n    \"firstName\": \"Jane\",\n    \"lastName\": \"Smith\",\n    \"userThumbnail\": \"https://example.com/avatar2.jpg\",\n    \"location\": \"San Francisco, USA\"\n  }\n]\n</code></pre></p>"},{"location":"api/reference/#create-or-update-user","title":"Create or Update User","text":"<p>Creates a new user or updates an existing one.</p> <p>Endpoint: <code>POST /api/v1/users</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Content-Type: <code>application/json</code></p> <p>Request Body: <pre><code>{\n  \"email\": \"newuser@example.com\",\n  \"firstName\": \"Alice\",\n  \"lastName\": \"Johnson\",\n  \"userThumbnail\": \"https://example.com/avatar.jpg\",\n  \"location\": \"Boston, USA\"\n}\n</code></pre></p> <p>Response (201 Created): <pre><code>{\n  \"message\": \"User created/updated successfully\"\n}\n</code></pre></p>"},{"location":"api/reference/#delete-user","title":"Delete User","text":"<p>Removes a user from the system.</p> <p>Endpoint: <code>DELETE /api/v1/users/{email}</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Response (200 OK): <pre><code>{\n  \"message\": \"User deleted successfully\"\n}\n</code></pre></p>"},{"location":"api/reference/#microapp-management","title":"MicroApp Management","text":""},{"location":"api/reference/#get-all-microapps","title":"Get All MicroApps","text":"<p>Retrieves all available MicroApps, filtered by user's group membership.</p> <p>Endpoint: <code>GET /api/v1/microapps</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Response (200 OK): <pre><code>[\n  {\n    \"id\": \"microapp-news\",\n    \"name\": \"News Portal\",\n    \"description\": \"Latest news and updates\",\n    \"icon\": \"https://example.com/news-icon.png\",\n    \"isActive\": true,\n    \"versions\": [\n      {\n        \"version\": \"1.0.0\",\n        \"downloadUrl\": \"https://example.com/news-v1.0.0.zip\",\n        \"isLatest\": true\n      }\n    ],\n    \"roles\": [\"user\", \"admin\"],\n    \"configs\": {\n      \"apiEndpoint\": \"https://news-api.example.com\",\n      \"theme\": \"dark\"\n    }\n  }\n]\n</code></pre></p>"},{"location":"api/reference/#get-microapp-by-id","title":"Get MicroApp by ID","text":"<p>Retrieves detailed information about a specific MicroApp.</p> <p>Endpoint: <code>GET /api/v1/microapps/{id}</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Response (200 OK): <pre><code>{\n  \"id\": \"microapp-news\",\n  \"name\": \"News Portal\",\n  \"description\": \"Latest news and updates\",\n  \"icon\": \"https://example.com/news-icon.png\",\n  \"isActive\": true,\n  \"versions\": [\n    {\n      \"version\": \"1.0.0\",\n      \"downloadUrl\": \"https://example.com/news-v1.0.0.zip\",\n      \"isLatest\": true\n    }\n  ],\n  \"roles\": [\"user\", \"admin\"],\n  \"configs\": {\n    \"apiEndpoint\": \"https://news-api.example.com\"\n  }\n}\n</code></pre></p>"},{"location":"api/reference/#create-or-update-microapp","title":"Create or Update MicroApp","text":"<p>Creates a new MicroApp or updates an existing one (admin function).</p> <p>Endpoint: <code>POST /api/v1/microapps</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Content-Type: <code>application/json</code></p> <p>Request Body: <pre><code>{\n  \"id\": \"microapp-weather\",\n  \"name\": \"Weather App\",\n  \"description\": \"Real-time weather forecasts\",\n  \"icon\": \"https://example.com/weather-icon.png\",\n  \"isActive\": true,\n  \"versions\": [\n    {\n      \"version\": \"1.0.0\",\n      \"downloadUrl\": \"https://example.com/weather-v1.0.0.zip\",\n      \"isLatest\": true\n    }\n  ],\n  \"roles\": [\"user\"],\n  \"configs\": {\n    \"apiKey\": \"weather-api-key-123\"\n  }\n}\n</code></pre></p> <p>Response (201 Created): <pre><code>{\n  \"message\": \"Microapp created/updated successfully\"\n}\n</code></pre></p>"},{"location":"api/reference/#deactivate-microapp","title":"Deactivate MicroApp","text":"<p>Deactivates a MicroApp, making it unavailable to users.</p> <p>Endpoint: <code>DELETE /api/v1/microapps/{id}</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Response (200 OK): <pre><code>{\n  \"message\": \"Microapp deactivated successfully\"\n}\n</code></pre></p>"},{"location":"api/reference/#user-configuration","title":"User Configuration","text":""},{"location":"api/reference/#get-user-configuration","title":"Get User Configuration","text":"<p>Retrieves user-specific configuration and preferences.</p> <p>Endpoint: <code>GET /api/v1/user-config</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Response (200 OK): <pre><code>{\n  \"userEmail\": \"user@example.com\",\n  \"downloadedMicroapps\": [\"microapp-news\", \"microapp-weather\"],\n  \"favoriteMicroapps\": [\"microapp-news\"],\n  \"preferences\": {\n    \"theme\": \"dark\",\n    \"notifications\": true\n  }\n}\n</code></pre></p>"},{"location":"api/reference/#update-user-configuration","title":"Update User Configuration","text":"<p>Updates user-specific configuration.</p> <p>Endpoint: <code>POST /api/v1/user-config</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Content-Type: <code>application/json</code></p> <p>Request Body: <pre><code>{\n  \"downloadedMicroapps\": [\"microapp-news\", \"microapp-weather\", \"microapp-events\"],\n  \"favoriteMicroapps\": [\"microapp-news\", \"microapp-weather\"],\n  \"preferences\": {\n    \"theme\": \"light\",\n    \"notifications\": false\n  }\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"message\": \"User configuration updated successfully\"\n}\n</code></pre></p>"},{"location":"api/reference/#push-notifications","title":"Push Notifications","text":""},{"location":"api/reference/#register-device-token","title":"Register Device Token","text":"<p>Registers a device token for push notifications.</p> <p>Endpoint: <code>POST /api/v1/notifications/register</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Content-Type: <code>application/json</code></p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\",\n  \"token\": \"fcm-device-token-xyz123\",\n  \"platform\": \"android\"\n}\n</code></pre></p> <p>Response (201 Created): <pre><code>(Empty body)\n</code></pre></p>"},{"location":"api/reference/#send-notification-service-endpoint","title":"Send Notification (Service Endpoint)","text":"<p>Sends push notifications to specified users. Called by MicroApp backends.</p> <p>Endpoint: <code>POST /api/v1/services/notifications/send</code></p> <p>Authentication: Service token (from Token Service)</p> <p>Content-Type: <code>application/json</code></p> <p>Request Body: <pre><code>{\n  \"userEmails\": [\"user1@example.com\", \"user2@example.com\"],\n  \"title\": \"New Article Published\",\n  \"body\": \"Check out the latest news!\",\n  \"data\": {\n    \"articleId\": \"123\",\n    \"category\": \"technology\"\n  }\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"success\": 2,\n  \"failed\": 0,\n  \"message\": \"Notifications sent successfully\"\n}\n</code></pre></p>"},{"location":"api/reference/#token-exchange","title":"Token Exchange","text":""},{"location":"api/reference/#exchange-user-token-for-microapp-token","title":"Exchange User Token for MicroApp Token","text":"<p>Exchanges an Asgardeo user token for a MicroApp-scoped token.</p> <p>Endpoint: <code>POST /api/v1/oauth/exchange</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Content-Type: <code>application/x-www-form-urlencoded</code></p> <p>Request Body: <pre><code>microapp_id=microapp-news&amp;scope=read write\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"access_token\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImRldi1rZXkiLCJ0eXAiOiJKV1QifQ...\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600\n}\n</code></pre></p>"},{"location":"api/reference/#get-jwks-public-keys","title":"Get JWKS (Public Keys)","text":"<p>Retrieves JSON Web Key Set for token validation.</p> <p>Endpoint: <code>GET /api/v1/.well-known/jwks.json</code></p> <p>Authentication: None (public endpoint)</p> <p>Response (200 OK): <pre><code>{\n  \"keys\": [\n    {\n      \"kty\": \"RSA\",\n      \"use\": \"sig\",\n      \"kid\": \"dev-key-example\",\n      \"n\": \"xOw3Yt...\",\n      \"e\": \"AQAB\",\n      \"alg\": \"RS256\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"api/reference/#file-management","title":"File Management","text":""},{"location":"api/reference/#upload-file","title":"Upload File","text":"<p>Uploads a file (binary data) to the system.</p> <p>Endpoint: <code>POST /api/v1/files?fileName={filename}</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Content-Type: <code>application/octet-stream</code></p> <p>Request Body: Binary file data</p> <p>Response (201 Created): <pre><code>{\n  \"message\": \"File uploaded successfully.\",\n  \"downloadUrl\": \"http://localhost:9090/public/micro-app-files/download/myfile.zip\"\n}\n</code></pre></p>"},{"location":"api/reference/#delete-file","title":"Delete File","text":"<p>Deletes a file from the system.</p> <p>Endpoint: <code>DELETE /api/v1/files?fileName={filename}</code></p> <p>Authentication: User token (Asgardeo)</p> <p>Response (204 No Content): <pre><code>(Empty body)\n</code></pre></p>"},{"location":"api/reference/#download-file-public","title":"Download File (Public)","text":"<p>Downloads a file. Public endpoint for MicroApp distribution.</p> <p>Endpoint: <code>GET /public/micro-app-files/download/{fileName}</code></p> <p>Authentication: None (public endpoint)</p> <p>Response (200 OK): <pre><code>Content-Type: application/octet-stream\nContent-Disposition: attachment; filename=\"myfile.zip\"\n\n&lt;binary file data&gt;\n</code></pre></p>"},{"location":"api/reference/#token-service-api","title":"Token Service API","text":""},{"location":"api/reference/#oauth-token-client-credentials","title":"OAuth Token (Client Credentials)","text":"<p>Issues a service token for MicroApp backend authentication.</p> <p>Endpoint: <code>POST /oauth/token</code></p> <p>Authentication: Basic Auth (client_id:client_secret)</p> <p>Content-Type: <code>application/x-www-form-urlencoded</code></p> <p>Request: <pre><code>curl -X POST http://localhost:8081/oauth/token \\\n  -u \"microapp-news:secret123\" \\\n  -d \"grant_type=client_credentials\"\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"access_token\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImRldi1rZXkiLCJ0eXAiOiJKV1QifQ...\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600\n}\n</code></pre></p>"},{"location":"api/reference/#create-oauth-client","title":"Create OAuth Client","text":"<p>Creates a new OAuth2 client for MicroApp backend authentication.</p> <p>Endpoint: <code>POST /oauth/clients</code></p> <p>Authentication: None (admin function - should be protected in production)</p> <p>Content-Type: <code>application/json</code></p> <p>Request Body: <pre><code>{\n  \"client_id\": \"microapp-weather\",\n  \"name\": \"Weather MicroApp Backend\",\n  \"scopes\": \"read write notifications:send\"\n}\n</code></pre></p> <p>Response (201 Created): <pre><code>{\n  \"client_id\": \"microapp-weather\",\n  \"client_secret\": \"aB3dE5fG7hI9jK1lM3nO5pQ7rS9tU1vW\",\n  \"name\": \"Weather MicroApp Backend\",\n  \"scopes\": \"read write notifications:send\",\n  \"is_active\": true\n}\n</code></pre></p> <p>\u26a0\ufe0f Important: The <code>client_secret</code> is only returned once. Store it securely.</p>"},{"location":"api/reference/#user-context-token","title":"User Context Token","text":"<p>Generates a token with user context for MicroApp frontends.</p> <p>Endpoint: <code>POST /oauth/token/user</code></p> <p>Authentication: None (called by Core Service)</p> <p>Content-Type: <code>application/x-www-form-urlencoded</code></p> <p>Request Body: <pre><code>grant_type=user_context&amp;user_email=user@example.com&amp;microapp_id=microapp-news&amp;scope=read write\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"access_token\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImRldi1rZXkiLCJ0eXAiOiJKV1QifQ...\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600\n}\n</code></pre></p>"},{"location":"api/reference/#get-jwks","title":"Get JWKS","text":"<p>Retrieves public keys for token validation.</p> <p>Endpoint: <code>GET /.well-known/jwks.json</code></p> <p>Authentication: None (public endpoint)</p> <p>Response (200 OK): <pre><code>{\n  \"keys\": [\n    {\n      \"kty\": \"RSA\",\n      \"use\": \"sig\",\n      \"kid\": \"dev-key-example\",\n      \"n\": \"xOw3Yt...\",\n      \"e\": \"AQAB\",\n      \"alg\": \"RS256\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"api/reference/#error-responses","title":"Error Responses","text":"<p>All endpoints may return the following error responses:</p>"},{"location":"api/reference/#400-bad-request","title":"400 Bad Request","text":"<pre><code>{\n  \"error\": \"invalid_request\",\n  \"error_description\": \"Missing required parameter: microapp_id\"\n}\n</code></pre>"},{"location":"api/reference/#401-unauthorized","title":"401 Unauthorized","text":"<pre><code>{\n  \"error\": \"unauthorized\",\n  \"error_description\": \"Invalid or expired token\"\n}\n</code></pre>"},{"location":"api/reference/#403-forbidden","title":"403 Forbidden","text":"<pre><code>{\n  \"error\": \"forbidden\",\n  \"error_description\": \"Insufficient permissions\"\n}\n</code></pre>"},{"location":"api/reference/#404-not-found","title":"404 Not Found","text":"<pre><code>{\n  \"error\": \"not_found\",\n  \"error_description\": \"Resource not found\"\n}\n</code></pre>"},{"location":"api/reference/#500-internal-server-error","title":"500 Internal Server Error","text":"<pre><code>{\n  \"error\": \"server_error\",\n  \"error_description\": \"An internal error occurred\"\n}\n</code></pre>"},{"location":"api/reference/#api-endpoint-summary","title":"API Endpoint Summary","text":""},{"location":"api/reference/#core-service-apiv1","title":"Core Service (<code>/api/v1</code>)","text":"Method Endpoint Description Auth GET <code>/users/me</code> Get current user info User GET <code>/users</code> Get all users User POST <code>/users</code> Create/update user User DELETE <code>/users/{email}</code> Delete user User GET <code>/microapps</code> Get all MicroApps User GET <code>/microapps/{id}</code> Get MicroApp by ID User POST <code>/microapps</code> Create/update MicroApp User DELETE <code>/microapps/{id}</code> Deactivate MicroApp User GET <code>/user-config</code> Get user configuration User POST <code>/user-config</code> Update user configuration User POST <code>/notifications/register</code> Register device token User POST <code>/oauth/exchange</code> Exchange token User GET <code>/.well-known/jwks.json</code> Get public keys Public POST <code>/files</code> Upload file User DELETE <code>/files</code> Delete file User GET <code>/public/micro-app-files/download/{fileName}</code> Download file Public"},{"location":"api/reference/#core-service-service-routes-apiv1services","title":"Core Service - Service Routes (<code>/api/v1/services</code>)","text":"Method Endpoint Description Auth POST <code>/notifications/send</code> Send push notification Service"},{"location":"api/reference/#token-service","title":"Token Service","text":"Method Endpoint Description Auth POST <code>/oauth/token</code> Get service token Basic Auth POST <code>/oauth/clients</code> Create OAuth client None POST <code>/oauth/token/user</code> Get user context token None GET <code>/.well-known/jwks.json</code> Get public keys Public POST <code>/admin/reload-keys</code> Reload signing keys None POST <code>/admin/active-key</code> Set active signing key None"},{"location":"api/reference/#rate-limiting","title":"Rate Limiting","text":"<p>\u26a0\ufe0f Production Recommendation: Implement rate limiting to prevent abuse.</p> <p>Suggested limits: - User endpoints: 100 requests/minute per user - Service endpoints: 1000 requests/minute per client - Public endpoints: 10 requests/minute per IP</p>"},{"location":"api/reference/#next-steps","title":"Next Steps","text":"<ul> <li>Architecture Overview: Understand how these APIs work together</li> <li>Installation Guide: Set up the development environment</li> <li>MicroApp Developer Guide: Build MicroApps that use these APIs</li> </ul>"},{"location":"architecture/overview/","title":"Architecture Overview","text":"<p>This document provides a comprehensive overview of LSF SuperApp Mobile architecture, including major components, technologies, and data flows.</p>"},{"location":"architecture/overview/#system-architecture","title":"System Architecture","text":""},{"location":"architecture/overview/#major-components","title":"Major Components","text":"Component Location Primary Technologies Key Responsibilities Mobile Application <code>frontend/</code> React Native, Expo SDK, Redux Toolkit, TypeScript, React Navigation, Expo WebView User authentication, MicroApp container &amp; lifecycle, WebView bridge, Push notifications, Local secure storage, OpenTelemetry Core Service <code>backend-services/core/</code> Go, Chi Router, GORM, Firebase Admin SDK, JWT validation MicroApp CRUD &amp; versioning, User management, Device token registration, Push notification dispatch, File I/O, Token exchange, Auth middleware Token Service <code>backend-services/token-service/</code> Go, Chi Router, GORM, JWT, OAuth2 JWT generation (S2S), JWKS endpoint, OAuth2 client credentials, User context tokens, Zero-downtime key rotation, Client secret management Admin Portal <code>superapp-admin-portal/</code> React, Vite, TypeScript, Axios MicroApp upload &amp; configuration, Version management, Role-based access control, User management interface"},{"location":"architecture/overview/#pluggable-services","title":"Pluggable Services","text":"<p>The SuperApp architecture supports pluggable services, allowing for flexible integration of various functionalities. These services can be independently developed, deployed, and scaled.</p> <ul> <li>Pluggable Services Overview</li> </ul>"},{"location":"architecture/overview/#api-documentation","title":"API Documentation","text":"<p>See API documentation for more details.</p> <ul> <li>API Documentation</li> </ul>"},{"location":"architecture/overview/#database-schema","title":"Database Schema","text":"<p>The SuperApp uses MySQL 8.0+ with a normalized relational schema supporting microapps, users, notifications, and OAuth clients.</p>"},{"location":"architecture/overview/#entity-relationship-diagram","title":"Entity Relationship Diagram","text":"<pre><code>erDiagram\n    users ||--o{ user_config : \"has\"\n    users {\n        varchar(100) email PK \"Primary Key\"\n        varchar(50) firstName\n        varchar(50) lastName\n        varchar(255) userThumbnail\n        varchar(100) location\n    }\n\n    user_config {\n        bigint id PK \"Auto Increment\"\n        varchar(191) email FK \"Foreign Key\"\n        varchar(191) config_key\n        json config_value\n        tinyint active \"1=active, 0=inactive\"\n        varchar(191) created_by\n        varchar(191) updated_by\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    micro_app ||--o{ micro_app_version : \"has versions\"\n    micro_app ||--o{ micro_app_role : \"has roles\"\n    micro_app ||--o{ micro_app_config : \"has config\"\n    micro_app {\n        int id PK \"Auto Increment\"\n        varchar(255) micro_app_id UK \"Unique Key\"\n        varchar(1024) name\n        text description\n        varchar(1024) promo_text\n        varchar(2083) icon_url\n        varchar(2083) banner_image_url\n        varchar(319) created_by\n        varchar(319) updated_by\n        datetime created_at\n        datetime updated_at\n        tinyint active \"1=active, 0=deleted\"\n        tinyint mandatory \"1=mandatory, 0=optional\"\n    }\n\n    micro_app_version {\n        int id PK \"Auto Increment\"\n        varchar(255) micro_app_id FK \"Foreign Key\"\n        varchar(32) version \"e.g., 1.0.0\"\n        int build \"Build number\"\n        text release_notes\n        varchar(2083) icon_url\n        varchar(2083) download_url\n        varchar(319) created_by\n        varchar(319) updated_by\n        datetime created_at\n        datetime updated_at\n        tinyint active\n    }\n\n    micro_app_role {\n        int id PK \"Auto Increment\"\n        varchar(255) micro_app_id FK \"Foreign Key\"\n        varchar(255) role \"Role name\"\n        tinyint active\n        varchar(319) created_by\n        varchar(319) updated_by\n        datetime created_at\n        datetime updated_at\n    }\n\n    micro_app_config {\n        bigint id PK \"Auto Increment\"\n        varchar(255) micro_app_id FK \"Foreign Key\"\n        varchar(191) config_key\n        json config_value\n        tinyint active\n        varchar(319) created_by\n        varchar(319) updated_by\n        datetime created_at\n        datetime updated_at\n    }\n\n    device_tokens {\n        bigint id PK \"Auto Increment\"\n        varchar(255) user_email \"References users.email\"\n        text device_token \"FCM/APNS token\"\n        enum platform \"ios, android\"\n        timestamp created_at\n        timestamp updated_at\n        tinyint is_active\n    }\n\n    notification_logs {\n        bigint id PK \"Auto Increment\"\n        varchar(255) user_email \"References users.email\"\n        varchar(255) title\n        text body\n        json data\n        timestamp sent_at\n        varchar(50) status \"sent, failed\"\n        varchar(100) microapp_id \"References micro_app\"\n    }\n\n    o_auth2_clients {\n        bigint id PK \"Auto Increment\"\n        varchar(255) client_id UK \"Unique Key\"\n        varchar(255) client_secret \"SHA256 hashed\"\n        varchar(255) name\n        varchar(1024) scopes \"Comma-separated\"\n        tinyint is_active\n        timestamp created_at\n        timestamp updated_at\n        timestamp deleted_at \"Soft delete\"\n    }\n\n    micro_apps_storage {\n        varchar(255) file_name PK \"Primary Key\"\n        mediumblob blob_content \"Binary file data\"\n    }</code></pre>"},{"location":"architecture/overview/#table-descriptions","title":"Table Descriptions","text":""},{"location":"architecture/overview/#core-tables","title":"Core Tables","text":"Table Name Description Primary Key Foreign Key Unique Constraints Other Notes users Stores user profile information <code>email</code> - - No timestamps (managed externally by IDP) user_config User-specific configuration settings (JSON) - <code>email</code> \u2192 <code>users.email</code> (CASCADE) (<code>email</code>, <code>config_key</code>) - micro_app MicroApp metadata and catalog information - - <code>micro_app_id</code> (business identifier) Soft delete via <code>active</code> flag micro_app_version Version history for each microapp - <code>micro_app_id</code> \u2192 <code>micro_app.micro_app_id</code> (CASCADE) (<code>micro_app_id</code>, <code>build</code>) - micro_app_role Role-based access control for microapps - <code>micro_app_id</code> \u2192 <code>micro_app.micro_app_id</code> (CASCADE) (<code>micro_app_id</code>, <code>role</code>) - micro_app_config Per-microapp configuration (JSON) - <code>micro_app_id</code> \u2192 <code>micro_app.micro_app_id</code> (CASCADE) (<code>micro_app_id</code>, <code>config_key</code>) -"},{"location":"architecture/overview/#other-tables","title":"Other Tables","text":"Table Name Description Primary Key Foreign Key Unique Constraints Other Notes device_tokens FCM/APNS device tokens for push notifications <code>id</code> - - Indexed on: <code>user_email</code>, <code>platform</code>, <code>is_active</code>. No FK (flexible design for external user systems) notification_logs Audit log of all sent notifications <code>id</code> - - Indexed on: <code>user_email</code>, <code>microapp_id</code>, <code>sent_at</code>, <code>status</code>. No FK (flexible design) o_auth2_clients OAuth2 client credentials for microapp backends <code>id</code> - <code>client_id</code> Soft delete via <code>deleted_at</code> timestamp. Secrets stored as SHA256 hash micro_apps_storage Binary file storage for microapp packages <code>file_name</code> - - Stores up to 16MB per file (MEDIUMBLOB)"},{"location":"architecture/overview/#foreign-key-relationships","title":"Foreign Key Relationships","text":"<pre><code>graph TD\n    users[users&lt;br/&gt;PK: email] --&gt;|CASCADE| user_config[user_config&lt;br/&gt;FK: email]\n\n    micro_app[micro_app&lt;br/&gt;PK: micro_app_id] --&gt;|CASCADE| micro_app_version[micro_app_version&lt;br/&gt;FK: micro_app_id]\n    micro_app --&gt;|CASCADE| micro_app_role[micro_app_role&lt;br/&gt;FK: micro_app_id]\n    micro_app --&gt;|CASCADE| micro_app_config[micro_app_config&lt;br/&gt;FK: micro_app_id]\n\n</code></pre> <p>CASCADE Rules: - When a <code>micro_app</code> is deleted, all related versions, roles, and configs are automatically deleted - When a <code>user</code> is deleted, all their configurations are automatically deleted - When a <code>micro_app_id</code> is updated, it propagates to all related tables</p>"},{"location":"architecture/overview/#indexing-strategy","title":"Indexing Strategy","text":"<p>Primary Indexes:</p> <ul> <li>All tables have primary keys (auto-increment or natural key).  </li> <li>Unique constraints on business identifiers (<code>micro_app_id</code>, <code>client_id</code>, <code>email</code>).  </li> </ul> <p>Foreign Key Indexes:</p> <ul> <li>All FK columns are indexed for JOIN performance.  </li> <li>Composite unique indexes on (<code>micro_app_id</code>, <code>build</code>), (<code>email</code>, <code>config_key</code>).  </li> </ul> <p>Query Optimization Indexes:</p> <ul> <li><code>active</code> flags for soft-delete queries.  </li> <li><code>user_email</code> for user-specific lookups.  </li> <li><code>platform</code>, <code>status</code>, <code>sent_at</code> for filtering.  </li> <li><code>created_at</code> for time-based queries.  </li> </ul>"},{"location":"architecture/overview/#data-types-constraints","title":"Data Types &amp; Constraints","text":"Type Usage Max Size <code>VARCHAR(100-319)</code> Emails, names 319 chars (max email) <code>VARCHAR(2083)</code> URLs 2083 chars (IE max URL) <code>TEXT</code> Large text 64KB <code>MEDIUMBLOB</code> Binary files 16MB <code>JSON</code> Structured config 1GB (theoretical) <code>DATETIME</code> Timestamps Date + Time <code>TIMESTAMP</code> Auto-updated Date + Time <code>TINYINT(1)</code> Boolean flags 0 or 1 <code>ENUM</code> Fixed values Platform types <p>Character Set: <code>utf8mb4</code> (full Unicode including emojis) Collation: <code>utf8mb4_0900_ai_ci</code> (accent-insensitive, case-insensitive)</p>"},{"location":"architecture/overview/#data-flow","title":"Data Flow","text":""},{"location":"architecture/overview/#flow-1-user-authentication","title":"Flow 1: User Authentication","text":"<pre><code>sequenceDiagram\n    participant User\n    participant App as Mobile App\n    participant ExternalIDP as External IDP\n    participant CS as Core Service\n\n    User-&gt;&gt;App: Opens mobile app\n    User-&gt;&gt;App: Taps on login\n    App-&gt;&gt;ExternalIDP: Redirects for authentication\n    User-&gt;&gt;ExternalIDP: Enters credentials\n    ExternalIDP--&gt;&gt;App: Returns user access token (after validation)\n    App-&gt;&gt;App: Stores token securely\n    App-&gt;&gt;CS: Calls Core Service with token (fetch user profile)\n    CS--&gt;&gt;App: Returns user profile\n    App-&gt;&gt;User: Displays home screen</code></pre>"},{"location":"architecture/overview/#flow-2-microapp-loading","title":"Flow 2: MicroApp Loading","text":"<pre><code>sequenceDiagram\n    participant User\n    participant App as Mobile App\n    participant CS as Core Service\n    participant TS as Token Service\n    participant MicroAppFE as MicroApp Frontend\n\n    User-&gt;&gt;App: Navigates to \"My Apps\"\n    App-&gt;&gt;User: Displays installed MicroApps\n\n    User-&gt;&gt;App: Taps \"Store\"\n    App-&gt;&gt;CS: Requests MicroApp Catalog\n    CS--&gt;&gt;App: Returns MicroApp Catalog\n    App-&gt;&gt;User: Displays MicroApp Store/Catalog\n\n    User-&gt;&gt;App: Selects and taps \"Install MicroApp X\"\n    App-&gt;&gt;CS: Requests MicroApp X manifest/assets\n    CS--&gt;&gt;App: Returns MicroApp X manifest/assets\n    App-&gt;&gt;App: Stores MicroApp X locally (manifest, assets)\n    App-&gt;&gt;App: Adds MicroApp X to \"My Apps\" list\n    App-&gt;&gt;User: Displays updated \"My Apps\" list\n\n    User-&gt;&gt;App: Taps on installed MicroApp X\n    App-&gt;&gt;App: Initializes WebView\n    App-&gt;&gt;TS: Requests MicroApp Token (if needed, with user/MicroApp context)\n    TS--&gt;&gt;App: Returns MicroApp Token\n    App-&gt;&gt;MicroAppFE: Loads MicroApp X in WebView (with token if applicable)\n    MicroAppFE--&gt;&gt;App: Loads MicroApp X content\n    App-&gt;&gt;User: Displays MicroApp X in WebView</code></pre>"},{"location":"architecture/overview/#authentication-architecture","title":"Authentication Architecture","text":""},{"location":"architecture/overview/#dual-idp-design","title":"Dual IDP Design","text":"<p>The platform uses two separate Identity Providers:</p> IDP Purpose Technology Audience External IdP User authentication OIDC/OAuth2 Mobile app users, Admin Portal users Token Service (Internal) Service authentication OAuth2 + JWT MicroApp backends"},{"location":"architecture/overview/#token-types","title":"Token Types","text":"Token Type Issuer Audience Subject Use Case User Token External IdP SuperApp User email Mobile app \u2192 Core Service MicroApp Token Token Service MicroApp ID User email MicroApp frontend \u2192 MicroApp backend Service Token Token Service <code>superapp-api</code> MicroApp ID MicroApp backend \u2192 Core Service"},{"location":"architecture/overview/#how-tokens-are-used","title":"How Tokens are used","text":""},{"location":"architecture/overview/#pattern-1-user-data-access","title":"Pattern 1: User Data Access","text":"<pre><code>sequenceDiagram\n    participant MA as Mobile App\n    participant CS as Core Service\n    participant AJ as External IdP JWKS\n\n    MA-&gt;&gt;CS: User Token (for user data)\n    CS-&gt;&gt;CS: Check JWKS cache\n    alt JWKS not cached or expired\n        CS-&gt;&gt;AJ: Request JWKS\n        AJ--&gt;&gt;CS: JWKS\n        CS-&gt;&gt;CS: Cache JWKS\n    end\n    alt Token Validation\n        CS-&gt;&gt;CS: Validate User Token using JWKS\n        alt Validation success\n            CS--&gt;&gt;MA: User-specific data\n        else Validation fails\n            CS--&gt;&gt;MA: Error: Invalid Token\n        end\n    end</code></pre>"},{"location":"architecture/overview/#pattern-2-microapp-data-access","title":"Pattern 2: MicroApp Data Access","text":"<pre><code>sequenceDiagram\n    participant MAF as MicroApp Frontend\n    participant SAF as SuperApp Frontend\n    participant CS as Core Service\n    participant TS as Token Service\n    participant MAB as MicroApp Backend\n\n    MAF-&gt;&gt;SAF: Request MicroApp Token (via Bridge)\n    SAF-&gt;&gt;CS: Request MicroApp Token\n    CS-&gt;&gt;CS: Validate User's Access Token (via External IdP JWKS)\n    CS-&gt;&gt;CS: Extract User Information from Access Token\n    CS-&gt;&gt;TS: Generate MicroApp Token (microapp_id, user_email)\n    TS--&gt;&gt;CS: MicroApp Token\n    CS--&gt;&gt;SAF: MicroApp Token\n    SAF--&gt;&gt;MAF: MicroApp Token\n    MAF-&gt;&gt;MAB: API Call (MicroApp Token)\n    MAB-&gt;&gt;CS: Request Token Service's JWKS\n    CS-&gt;&gt;TS : Fetch JWKS\n    TS--&gt;&gt;CS: JWKS\n    CS--&gt;&gt;MAB: JWKS\n    MAB-&gt;&gt;MAB: Validate MicroApp Token using JWKS\n    MAB--&gt;&gt;MAF: send requested data</code></pre>"},{"location":"architecture/overview/#pattern-3-service-to-service","title":"Pattern 3: Service-to-Service","text":"<pre><code>sequenceDiagram\n    participant MAB as MicroApp Backend\n    participant CS as Core Service\n    participant TS as Token Service\n\n    MAB-&gt;&gt;CS: Request Service specific Access Token (client_id, client_secret)\n    CS-&gt;&gt;TS: Request Service specific Access Token (client_id, client_secret)\n    TS-&gt;&gt;TS: Validate client_id and client_secret\n    alt Validation successful\n        TS--&gt;&gt;TS: Generate Service Token\n        TS--&gt;&gt;CS: Service Token\n        CS--&gt;&gt;MAB: Service Token\n        MAB-&gt;&gt;CS: Call Core Service Endpoint (Service Token)\n        CS-&gt;&gt;CS: Validate Service Token (via Token Service's JWKS)\n        alt Token valid\n            CS-&gt;&gt;CS: Invoke requested service\n            CS--&gt;&gt;MAB: Service Response\n        else Token invalid\n            CS--&gt;&gt;MAB: Error: Invalid Service Token\n        end\n    else Validation failed\n        TS--&gt;&gt;CS: Error: Invalid Credentials\n        CS--&gt;&gt;MAB: Error: Service Token Generation Failed\n    end</code></pre>"},{"location":"architecture/overview/#scalability-performance","title":"Scalability &amp; Performance","text":""},{"location":"architecture/overview/#horizontal-scaling","title":"Horizontal Scaling","text":"<ul> <li>Stateless Services: Core and Token services are stateless</li> <li>Database Connection Pooling: Configurable pool sizes</li> <li>Load Balancing: Services can run multiple instances</li> </ul>"},{"location":"architecture/overview/#caching-strategies","title":"Caching Strategies","text":"<ul> <li>JWKS Caching: Clients cache public keys (1 hour TTL)</li> <li>MicroApp Caching: Mobile app stores MicroApps locally</li> <li>Database Indexing: Optimized queries on frequently accessed tables</li> </ul>"},{"location":"architecture/overview/#observability","title":"Observability","text":"<ul> <li>OpenTelemetry: Metrics collection from mobile app</li> <li>Prometheus: Time-series metrics storage</li> <li>Structured Logging: JSON logs with <code>slog</code> (Go services)</li> </ul>"},{"location":"architecture/overview/#key-metrics-collected-for-monitoring-performance","title":"Key Metrics Collected for monitoring performance","text":"<ul> <li><code>api_request_count_total</code> </li> <li><code>api_request_duration_bucket</code> </li> <li><code>microapp_load_count_total</code> </li> <li><code>auth_token_refresh_count_total</code> </li> </ul>"},{"location":"architecture/overview/#next-steps","title":"Next Steps","text":"<ul> <li>API Reference: Explore all available endpoints</li> <li>Installation Guide: Set up the development environment</li> <li>MicroApp Development: Build your first MicroApp</li> </ul>"},{"location":"getting-started/installation/","title":"Getting Started with SuperApp","text":"<p>Welcome! This guide will help you get started with the SuperApp platform based on your role.</p>"},{"location":"getting-started/installation/#choose-your-path","title":"Choose Your Path","text":"<p>Select the role that best describes what you want to do:</p> <ul> <li> <p> SuperApp Platform Deployer</p> <p>You're setting up and deploying the complete SuperApp infrastructure for your organization.</p> <p>Your responsibilities:</p> <ul> <li>Deploy backend services (Core &amp; Token Service)</li> <li>Set up databases and infrastructure</li> <li>Configure external authentication providers</li> <li>Build and deploy the mobile application</li> <li>Monitor system health and performance</li> </ul> <p> Start here:</p> <p> Deployment Guide</p> <p> Next:</p> <ul> <li>Architecture Overview - Understand the system</li> <li>Core Service Guide - Main API service</li> <li>Token Service Guide - Internal OAuth2/JWT service</li> <li>Mobile App Guide - Mobile app setup</li> <li>Observability - Monitoring setup</li> <li>Pluggable Backend Services - Custom File and User Management Services</li> <li>Bridge Guide - Bridge Overview</li> </ul> </li> <li> <p> MicroApp Developer</p> <p>You're building web applications that will run inside the SuperApp container.</p> <p>Your responsibilities:</p> <ul> <li>Develop web apps using your preferred framework</li> <li>Integrate with SuperApp via the Bridge API</li> <li>Access native device features</li> <li>Package and publish your micro-apps</li> <li>Handle authentication and authorization</li> </ul> <p> Start here:</p> <p> MicroApp Developer Guide</p> <p> Next:</p> <ul> <li>Bridge API Reference - Native feature access</li> <li>Push Notifications - Send notifications to users</li> <li>Sample MicroApps</li> </ul> </li> <li> <p> Platform Administrator</p> <p>You're managing the SuperApp platform, users, and micro-apps through the admin portal.</p> <p>Your responsibilities:</p> <ul> <li>Manage micro-app catalog and versions</li> <li>Upload and publish micro-apps</li> <li>Create OAuth clients for micro-app backends</li> <li>Manage user access and permissions</li> <li>Configure platform settings</li> </ul> <p> Start here:</p> <p> Admin Portal Guide</p> </li> </ul>"},{"location":"getting-started/installation/#need-help","title":"Need Help?","text":"<p>Not sure which path to choose?</p> <ul> <li>Want to set up the platform? \u2192 Start with SuperApp Platform Deployer</li> <li>Want to build apps for the platform? \u2192 Start with MicroApp Developer</li> <li>Want to manage the platform? \u2192 Start with Platform Administrator</li> </ul>"},{"location":"getting-started/installation/#additional-resources","title":"Additional Resources","text":"<ul> <li> GitHub Repository - Source code and issues</li> <li> Architecture Overview - System design and components</li> <li> API Reference - Complete API documentation</li> <li> Full Documentation - Back to documentation home</li> </ul>"},{"location":"microapp-developer/bridge-api/","title":"Bridge Communication Guide","text":""},{"location":"microapp-developer/bridge-api/#quick-reference-available-bridge-functions","title":"Quick Reference (Available Bridge Functions)","text":"Method Returns Description <code>requestToken()</code> <code>Promise&lt;string&gt;</code> Retrieve authentication token for API calls <code>requestAlert({...})</code> <code>Promise&lt;void&gt;</code> Display native alert dialog <code>requestConfirmAlert({...})</code> <code>Promise&lt;\"confirm\" \\| \"cancel\"&gt;</code> Display native confirmation dialog <code>requestCloseWebview()</code> <code>void</code> Navigate back/close current MicroApp <code>requestQRCode()</code> <code>Promise&lt;string&gt;</code> Activate QR scanner and get scanned code <code>requestDeviceSafeAreaInsets()</code> <code>Promise&lt;{top, bottom, left, right}&gt;</code> Get device safe area insets <code>requestSaveLocalData({...})</code> <code>Promise&lt;void&gt;</code> Persist data using AsyncStorage <code>requestGetLocalData({...})</code> <code>Promise&lt;{value: string \\| null}&gt;</code> Retrieve data from AsyncStorage <code>requestAuthenticateWithGoogle()</code> <code>Promise&lt;UserInfo&gt;</code> Initiate Google OAuth flow <code>requestCheckGoogleAuthState()</code> <code>Promise&lt;boolean \\| UserInfo&gt;</code> Check Google auth status <code>requestGoogleUserInfo()</code> <code>Promise&lt;UserInfo&gt;</code> Get Google user information <code>requestUploadToGoogleDrive(data)</code> <code>Promise&lt;{id: string}&gt;</code> Upload to Google Drive <code>requestRestoreGoogleDriveBackup()</code> <code>Promise&lt;any&gt;</code> Restore backup from Google Drive <code>requestDownloadFile({...})</code> <code>Promise&lt;{localPath: string}&gt;</code> Download file to device <code>requestTotpQrMigrationData()</code> <code>Promise&lt;{data: string}&gt;</code> Get TOTP migration QR data <code>requestNativeLog({...})</code> <code>void</code> Log to native console (dev only)"},{"location":"microapp-developer/bridge-api/#overview","title":"Overview","text":"<p>The Bridge is a communication layer that enables secure, bidirectional messaging between the SuperApp (React Native) and embedded MicroApps (web applications running in WebViews). This architecture allows MicroApps to access native device capabilities and SuperApp services while maintaining security boundaries.</p>"},{"location":"microapp-developer/bridge-api/#underlying-technology","title":"Underlying Technology","text":"<p>The Bridge leverages React Native's WebView component and the <code>postMessage</code> API for cross-context communication:</p> <ul> <li>Message Passing: Uses <code>window.ReactNativeWebView.postMessage()</code> for MicroApp \u2192 SuperApp communication</li> <li>Promise System: Promise-based responses for SuperApp \u2192 MicroApp communication</li> <li>Type Safety: Auto-generated TypeScript definitions ensure compile-time safety</li> <li>Registry Pattern: Centralized function registry for maintainable bridge management</li> </ul>"},{"location":"microapp-developer/bridge-api/#architecture","title":"Architecture","text":""},{"location":"microapp-developer/bridge-api/#developer-roles","title":"Developer Roles","text":""},{"location":"microapp-developer/bridge-api/#superapp-developer","title":"SuperApp Developer","text":"<p>Responsible for maintaining the bridge infrastructure and implementing native functionality. This includes:</p> <ul> <li>Adding new bridge functions to the registry</li> <li>Implementing native handlers with device/platform access</li> <li>Managing security and permissions</li> <li>Updating bridge types and documentation</li> </ul>"},{"location":"microapp-developer/bridge-api/#microapp-developer","title":"MicroApp Developer","text":"<p>Develops web applications that integrate with the SuperApp through the bridge. Responsibilities include:</p> <ul> <li>Using bridge APIs to access native features via promises</li> <li>Handling asynchronous responses with async/await</li> <li>Managing bridge state and error conditions</li> <li>Following security best practices for cross-origin communication</li> </ul>"},{"location":"microapp-developer/bridge-api/#for-superapp-developers-adding-bridge-functions","title":"For SuperApp Developers: Adding Bridge Functions","text":""},{"location":"microapp-developer/bridge-api/#bridge-function-structure","title":"Bridge Function Structure","text":"<p>Each bridge function is defined in <code>frontend/utils/bridgeRegistry.ts</code> with the following interface:</p> <pre><code>interface BridgeFunction {\n  topic: string; // Unique identifier for the function\n  handler: (params: any, context: BridgeContext) =&gt; Promise&lt;void&gt; | void;\n  // Method names are auto-generated from topic:\n  // - request: `request${camelCase(topic)}`\n  // - resolve: `resolve${camelCase(topic)}`\n  // - reject: `reject${camelCase(topic)}`\n  // - helper: `get${camelCase(topic)}`\n}\n</code></pre>"},{"location":"microapp-developer/bridge-api/#context-object","title":"Context Object","text":"<p>The handler receives a <code>BridgeContext</code> object, which provides convenient access to relevant data and utility methods for bridge operations. This context includes:</p> <pre><code>interface BridgeContext {\n  // Core data\n  topic: string; // Current bridge topic (auto-injected)\n  appID: string; // Current MicroApp ID\n  token: string | null; // Authentication token\n\n  // UI controls\n  setScannerVisible: (visible: boolean) =&gt; void; // Control QR scanner visibility\n\n  // Communication\n  sendResponseToWeb: (method: string, data?: any, requestId?: string) =&gt; void; // Send custom response to MicroApp\n  pendingTokenRequests: ((token: string) =&gt; void)[]; // Token request queue\n\n  // Convenience methods that auto-generate method names from topic\n  resolve: (data?: any, requestId?: string) =&gt; void; // Auto-generates resolve method name\n  reject: (error: string, requestId?: string) =&gt; void; // Auto-generates reject method name\n\n  // Optional features (available based on context)\n  promptAsync?: () =&gt; Promise&lt;any&gt;; // Google authentication prompt\n  router?: { back: () =&gt; void }; // Navigation router\n  insets?: {\n    // Safe area insets for device\n    top: number;\n    bottom: number;\n    left: number;\n    right: number;\n  };\n  qrScanCallback?: (qrCode: string) =&gt; void; // QR scanner result callback\n}\n</code></pre>"},{"location":"microapp-developer/bridge-api/#adding-a-new-bridge-function","title":"Adding a New Bridge Function","text":"<p>Each bridge function lives in its own file under <code>frontend/utils/bridgeHandlers/</code>, and <code>frontend/utils/bridgeHandlers/index.ts</code> aggregates all handlers into the <code>BRIDGE_REGISTRY</code> array which the runtime uses.</p> <p>1. Create a handler file: </p> <p>Path: <code>frontend/utils/bridgeHandlers/&lt;your_topic&gt;.ts</code></p> <p>Export a <code>BRIDGE_FUNCTION</code> object with <code>topic</code> and <code>handler</code>. Example template:</p> <pre><code>// frontend/utils/bridgeHandlers/example_handler.ts\nimport { BridgeFunction, BridgeContext } from \"./bridgeTypes\";\n\nexport const BRIDGE_FUNCTION: BridgeFunction = {\n  topic: \"example_topic\",\n  handler: async (params: any, context: BridgeContext) =&gt; {\n    try {\n      if (!params) {\n        context.reject(\"Missing parameters\");\n        return;\n      }\n\n      // Your logic here\n      const result = { ok: true, received: params };\n      context.resolve(result);\n    } catch (err) {\n      context.reject(err instanceof Error ? err.message : String(err));\n    }\n  },\n};\n</code></pre> <p>2. Register the handler:</p> <p>Import the new file in <code>frontend/utils/bridgeHandlers/index.ts</code> and include the exported <code>BRIDGE_FUNCTION</code> in the exported <code>BRIDGE_REGISTRY</code> array. The registry file is imported by the runtime (<code>frontend/utils/bridgeRegistry.ts</code>)</p> <p>and that's it! :)</p>"},{"location":"microapp-developer/bridge-api/#best-practices-for-superapp-developers","title":"Best Practices for SuperApp Developers","text":"<ul> <li>Use descriptive topic names: Prefer <code>user_profile</code> over <code>data</code></li> <li>Implement proper error handling: Always wrap operations in try/catch</li> <li>Validate parameters: Check required fields before processing</li> <li>Use async/await: For operations that may block the UI thread</li> <li>Handle callbacks properly: For UI-triggered events, use context callback storage pattern</li> <li>Maintain backward compatibility: When adding new features, ensure existing MicroApps continue to work</li> </ul>"},{"location":"microapp-developer/bridge-api/#security-considerations","title":"Security Considerations","text":"<ul> <li>Input Validation: Always validate parameters from MicroApps</li> <li>Permission Checks: Verify user permissions before executing sensitive operations</li> <li>Token Security: Never log or expose tokens in plain text</li> <li>Cross-Origin: Bridge only works within authorized WebViews</li> <li>Data Sanitization: Clean user inputs before processing</li> </ul>"},{"location":"microapp-developer/bridge-api/#for-microapp-developers-using-bridge-apis","title":"For MicroApp Developers: Using Bridge APIs","text":""},{"location":"microapp-developer/bridge-api/#initialization","title":"Initialization","text":"<p>The bridge is automatically injected into MicroApps via WebView JavaScript injection. Access it through:</p> <pre><code>// Check if bridge is available\nif (window.nativebridge) {\n  // Bridge is ready to use\n}\n</code></pre>"},{"location":"microapp-developer/bridge-api/#making-requests","title":"Making Requests","text":"<p>All bridge functions return promises for cleaner asynchronous handling:</p> <pre><code>// Example: Request token\ntry {\n  const token = await window.nativebridge.requestToken();\n} catch (error) {\n  console.error(\"Token request failed:\", error);\n}\n</code></pre>"},{"location":"microapp-developer/bridge-api/#promise-based-best-practices","title":"Promise-based Best Practices","text":"<ul> <li>Use async/await: For cleaner, more readable asynchronous code</li> <li>Handle errors: Always wrap bridge calls in try/catch blocks</li> <li>Type responses: Use TypeScript for better development experience</li> <li>Avoid blocking: Don't call bridge functions in render loops</li> </ul> <pre><code>// Example with proper error handling\nasync function loadUserData() {\n  try {\n    const token = await window.nativebridge.requestToken();\n    // const { sub } = decodeJwt(token)\n  } catch (error) {\n    console.error(\"Failed to load user data:\", error);\n    // Handle error appropriately\n  }\n}\n</code></pre>"},{"location":"microapp-developer/bridge-api/#available-bridge-functions","title":"Available Bridge Functions","text":""},{"location":"microapp-developer/bridge-api/#authentication-identity","title":"Authentication &amp; Identity","text":""},{"location":"microapp-developer/bridge-api/#token-management","title":"Token Management","text":"<ul> <li>Request: <code>await window.nativebridge.requestToken()</code> \u2192 <code>Promise&lt;string&gt;</code></li> <li>Purpose: Retrieve authentication token for API calls</li> <li>Note: Token is automatically sent when available, also supports request-based retrieval</li> </ul>"},{"location":"microapp-developer/bridge-api/#user-interface","title":"User Interface","text":""},{"location":"microapp-developer/bridge-api/#alert-dialog","title":"Alert Dialog","text":"<ul> <li>Request: <code>await window.nativebridge.requestAlert({\"title\": title, \"message\": message,\"buttonText\": buttonText})</code></li> <li>Purpose: Display native alert dialog</li> </ul>"},{"location":"microapp-developer/bridge-api/#confirmation-dialog","title":"Confirmation Dialog","text":"<ul> <li>Request: <code>await window.nativebridge.requestConfirmAlert({title, message, confirmButtonText, cancelButtonText})</code> \u2192 <code>Promise&lt;\"confirm\" | \"cancel\"&gt;</code></li> <li>Purpose: Display native confirmation dialog with two options</li> </ul>"},{"location":"microapp-developer/bridge-api/#close-webview","title":"Close WebView","text":"<ul> <li>Request: <code>window.nativebridge.requestCloseWebview()</code></li> <li>Purpose: Navigate back/close the current MicroApp WebView</li> </ul>"},{"location":"microapp-developer/bridge-api/#device-features","title":"Device Features","text":""},{"location":"microapp-developer/bridge-api/#qr-code-scanner","title":"QR Code Scanner","text":"<ul> <li>Request: <code>await window.nativebridge.requestQRCode()</code> \u2192 <code>Promise&lt;string&gt;</code></li> <li>Purpose: Activate native QR code scanner and get scanned code</li> <li>Returns: Promise that resolves with the scanned QR code string</li> </ul>"},{"location":"microapp-developer/bridge-api/#device-safe-area-insets","title":"Device Safe Area Insets","text":"<ul> <li>Request: <code>await window.nativebridge.requestDeviceSafeAreaInsets()</code> \u2192 <code>Promise&lt;{top, bottom, left, right}&gt;</code></li> <li>Purpose: Get device safe area insets for proper UI layout</li> </ul>"},{"location":"microapp-developer/bridge-api/#data-storage","title":"Data Storage","text":""},{"location":"microapp-developer/bridge-api/#save-local-data","title":"Save Local Data","text":"<ul> <li>Request: <code>await window.nativebridge.requestSaveLocalData({key, value})</code> \u2192 <code>Promise&lt;void&gt;</code></li> <li>Purpose: Persist data using AsyncStorage</li> <li>Note: Value will be stored as a string</li> </ul>"},{"location":"microapp-developer/bridge-api/#get-local-data","title":"Get Local Data","text":"<ul> <li>Request: <code>await window.nativebridge.requestGetLocalData({key})</code> \u2192 <code>Promise&lt;{value: string | null}&gt;</code></li> <li>Purpose: Retrieve persisted data from AsyncStorage</li> </ul>"},{"location":"microapp-developer/bridge-api/#google-services","title":"Google Services","text":""},{"location":"microapp-developer/bridge-api/#google-authentication","title":"Google Authentication","text":"<ul> <li>Request: <code>await window.nativebridge.requestAuthenticateWithGoogle()</code> \u2192 <code>Promise&lt;UserInfo&gt;</code></li> <li>Purpose: Initiate Google OAuth flow and get user information</li> </ul>"},{"location":"microapp-developer/bridge-api/#check-google-auth-state","title":"Check Google Auth State","text":"<ul> <li>Request: <code>await window.nativebridge.requestCheckGoogleAuthState()</code> \u2192 <code>Promise&lt;boolean | UserInfo&gt;</code></li> <li>Purpose: Check if user is authenticated with Google</li> </ul>"},{"location":"microapp-developer/bridge-api/#get-google-user-info","title":"Get Google User Info","text":"<ul> <li>Request: <code>await window.nativebridge.requestGoogleUserInfo()</code> \u2192 <code>Promise&lt;UserInfo&gt;</code></li> <li>Purpose: Get authenticated Google user's information</li> </ul>"},{"location":"microapp-developer/bridge-api/#upload-to-google-drive","title":"Upload to Google Drive","text":"<ul> <li>Request: <code>await window.nativebridge.requestUploadToGoogleDrive(data)</code> \u2192 <code>Promise&lt;{id: string}&gt;</code></li> <li>Purpose: Upload data/file to user's Google Drive</li> </ul>"},{"location":"microapp-developer/bridge-api/#restore-from-google-drive","title":"Restore from Google Drive","text":"<ul> <li>Request: <code>await window.nativebridge.requestRestoreGoogleDriveBackup()</code> \u2192 <code>Promise&lt;any&gt;</code></li> <li>Purpose: Restore latest backup data from Google Drive</li> </ul>"},{"location":"microapp-developer/bridge-api/#file-downloads","title":"File Downloads","text":"<ul> <li>Request: <code>await window.nativebridge.requestDownloadFile({ url, filename? })</code> \u2192 <code>Promise&lt;{ localPath: string }&gt;</code></li> <li>Purpose: Download a file from a URL (or base64 data) into the device app storage and return the local path; the native layer may optionally offer a share/save UI.</li> <li>Params:</li> <li><code>url</code> (string): HTTP(S) URL of the file to download</li> <li><code>filename</code> (optional string): Desired filename on the device. If omitted, filename is derived from the URL or a timestamp is used.</li> <li>Returns: <code>{ localPath }</code> \u2014 local file URI in the device's document directory</li> <li>Note: The handler will try to use native sharing APIs when available to let users open or save the file elsewhere.</li> <li>Note: On Android, the handler attempts to save directly to the public Downloads folder (<code>/storage/emulated/0/Download</code>) when permitted; it may request runtime <code>WRITE_EXTERNAL_STORAGE</code> on older devices. If permission is denied or unsupported, it falls back to the app's external storage folder (e.g., <code>Android/data/&lt;package&gt;/files/Download</code>).</li> <li>Behavior: When <code>url</code> is provided, the bridge opens the URL via the user's browser (<code>Linking.openURL</code>) so the browser handles the full download and the MicroApp itself does not perform the write. When <code>base64</code> content is provided, the bridge writes the file into the app cache and opens the system share/save dialog so the user can pick where to save the file (e.g., Downloads).</li> <li>Behavior: When <code>url</code> is provided, the bridge opens the URL via the user's browser (<code>Linking.openURL</code>) so the browser handles the full download and the MicroApp itself does not perform the write. When <code>base64</code> content is provided, the bridge first tries to open a data-URL HTML wrapper that will trigger a browser download (this works in many mobile browsers). If that fails (data URL too large or the browser doesn't support it), the bridge falls back to writing the file into the app cache and opening the system share/save dialog so the user can pick where to save the file (e.g., Downloads).</li> <li>Option: Pass <code>saveToDownloads: true</code> with <code>base64</code> payload on Android to use Storage Access Framework (SAF) and let the user pick a directory (choose Downloads) \u2014 this saves the file directly into that directory.</li> </ul> <p>Usage:</p> <pre><code>// From a MicroApp running inside the WebView:\ntry {\n  const { localPath } = await window.nativebridge.requestDownloadFile({\n    url: \"https://example.com/somefile.pdf\",\n    filename: \"example.pdf\",\n  });\n  console.log(\"Downloaded to\", localPath);\n} catch (err) {\n  console.error(\"Download failed\", err);\n}\n</code></pre>"},{"location":"microapp-developer/bridge-api/#totp-time-based-one-time-password","title":"TOTP (Time-based One-Time Password)","text":""},{"location":"microapp-developer/bridge-api/#totp-qr-migration-data","title":"TOTP QR Migration Data","text":"<ul> <li>Request: <code>await window.nativebridge.requestTotpQrMigrationData()</code> \u2192 <code>Promise&lt;{data: string}&gt;</code></li> <li>Purpose: Get TOTP migration data for QR code generation</li> </ul>"},{"location":"microapp-developer/bridge-api/#development-debugging","title":"Development &amp; Debugging","text":""},{"location":"microapp-developer/bridge-api/#native-log","title":"Native Log","text":"<ul> <li>Request: <code>window.nativebridge.requestNativeLog({level, message, data})</code></li> <li>Purpose: Log messages to native console (only works in development mode)</li> <li>Levels: <code>\"info\"</code>, <code>\"warn\"</code>, <code>\"error\"</code></li> </ul>"},{"location":"microapp-developer/getting-started/","title":"Micro\u2011App Developer Guide","text":"<p>This guide shows you how to build, test, package, and publish a web Micro\u2011App that runs inside the Super App's WebView.</p> <p>New to MicroApps? Start with Bridge Overview to understand the fundamentals. Ready to build? Jump to Quickstart for a quick example.</p>"},{"location":"microapp-developer/getting-started/#quickstart-hello-microapp","title":"Quickstart (Hello Micro\u2011App)","text":"<p>1. Scaffold a web app (any framework works). Example: React + Vite</p> <pre><code>npm create vite@latest my-microapp -- --template react-ts\ncd my-microapp\nnpm install\n</code></pre> <p>2. Add safe bridge access and a simple call</p> <pre><code>// src/App.tsx\nimport { useEffect, useState } from \"react\";\n\nexport default function App() {\n  const [tokenPreview, setTokenPreview] = useState&lt;string | undefined&gt;();\n\n  // Detect if running inside the SuperApp host\n  const inHost = typeof (window as any).nativebridge?.requestToken === \"function\";\n\n  useEffect(() =&gt; {\n    const run = async () =&gt; {\n      if (!inHost) return;\n      try {\n\n        // Request a token from the host using the bridge\n        const token = await (window as any).nativebridge.requestToken();\n\n        setTokenPreview(token ? token.slice(0, 12) + \"\u2026\" : undefined);\n      } catch (e) {\n        console.error(\"requestToken failed\", e);\n      }\n    };\n    run();\n  }, [inHost]);\n\n  return (\n    &lt;main style={{ padding: 24 }}&gt;\n      &lt;h1&gt;My Micro\u2011App&lt;/h1&gt;\n      &lt;p&gt;Host detected: {inHost ? \"Yes\" : \"No (browser preview)\"}&lt;/p&gt;\n      &lt;p&gt;Token: {tokenPreview ?? \"\u2014\"}&lt;/p&gt;\n      &lt;button\n        onClick={async () =&gt; {\n          try {\n\n            // Request an alert from the host\n            await (window as any).nativebridge?.requestAlert?.({\n              title: \"Hello\",\n              message: \"Welcome!\",\n              buttonText: \"OK\",\n            });\n\n          } catch (e) {\n            console.log(\"Alert not available in browser preview\");\n          }\n        }}\n      &gt;\n        Say Hi\n      &lt;/button&gt;\n    &lt;/main&gt;\n  );\n}\n</code></pre> <p>3. Run locally for browser preview</p> <pre><code>npm run dev\n</code></pre> <p>Optional: Add a tiny bridge polyfill for browser preview (no host), so your code doesn\u2019t crash:</p> <pre><code>// src/bridge-polyfill.ts (import it in main.tsx during local dev only)\ndeclare global {\n  interface Window {\n    nativebridge?: any;\n  }\n}\n\nif (!window.nativebridge) {\n  window.nativebridge = {\n    requestToken: async () =&gt; null,\n    requestAlert: async ({ title, message }: any) =&gt; {\n      // Browser fallback\n      alert(`${title}: ${message}`);\n    },\n  };\n}\n</code></pre> <p>Later, you\u2019ll build a ZIP and publish via the Admin Portal so the Super App can download and run it.</p>"},{"location":"microapp-developer/getting-started/#bridge-overview","title":"Bridge overview","text":"<p>Since Micro-apps run in a isolated webview container, to communicate with the host it is using a lightweight promise-based bridge exposed on <code>window.nativebridge</code>.</p> <pre><code>const data = await window.nativebridge.&lt;bridgeFunction&gt;();\n</code></pre> <p>Replace <code>&lt;bridgeFunction&gt;</code> with the specific method you need.</p> <p>Note</p> <ul> <li>See Available Bridge Methods</li> <li>All bridge calls are async; always use try/catch.</li> <li>If a request fails, the promise rejects with an error string.</li> </ul>"},{"location":"microapp-developer/getting-started/#naming-and-conventions","title":"Naming and conventions","text":"<ul> <li>Request method names follow the <code>requestXxx</code> pattern (e.g. <code>requestUserId</code>, <code>requestToken</code>).</li> <li>The host generates corresponding <code>resolveXxx</code> / <code>rejectXxx</code> handler names automatically; micro-apps only need to call <code>requestXxx</code>.</li> <li>Avoid touching <code>window.nativebridge._pendingPromises</code> or internal fields \u2014 only use the documented request functions.</li> </ul>"},{"location":"microapp-developer/getting-started/#how-to-detect-the-host-vs-stand-alone-web-mode","title":"How to detect the host vs stand-alone web mode","text":"<p>When running in a WebView inside the host, <code>window.nativebridge</code> will be available. Protect your code when running in a normal browser:</p> <pre><code>const inHost = typeof window.nativebridge?.requestToken === \"function\";\nif (inHost) {\n  const token = await window.nativebridge.requestToken();\n} else {\n  // fallback behavior for standalone web preview\n}\n</code></pre>"},{"location":"microapp-developer/getting-started/#packaging-metadata","title":"Packaging &amp; metadata","text":"<p>1. Build your app for production</p> <pre><code>npm run build\n</code></pre> <p>Your output directory will typically be <code>dist/</code> (Vite) or <code>build/</code> (CRA):</p> <pre><code>dist/ (or build/)\n\u251c\u2500\u2500 assets/\n\u251c\u2500\u2500 index.html\n\u2514\u2500\u2500 ...\n</code></pre> <p>2. Add a <code>microapp.json</code> file at the ROOT of the built output directory with these fields:,</p> <pre><code>{\n  \"name\": \"Micro App Name\",\n  \"description\": \"A brief description of the micro app\",\n  \"appId\": \"unique-app-id\",\n  \"clientId\": \"client-id-for-authentication-if-integrated\",\n  \"displayMode\": \"Controls whether to hide the header ('fullscreen') or show it ('default'). If no value is provided, it defaults to 'default'\"\n}\n</code></pre> <p>Field notes</p> <ul> <li> <p>appId: unique, URL\u2011safe identifier (e.g., \"calendar\", \"com.example.payroll\"). Use for determining micro-app identity. Which you'll receive from Super App Admin.</p> </li> <li> <p>clientId: OAuth2 client ID of the microapp if superapp use external IdP for authentication. otherwise, same as appId.</p> </li> <li> <p>displayMode: \"default\" (shows header) or \"fullscreen\" (no header, manage your own safe areas).</p> </li> <li> <p>Package as a ZIP</p> </li> <li> <p>Important: ZIP the CONTENTS of the build folder, not the folder itself.</p> </li> <li>Good: index.html, assets/, microapp.json at the root of the ZIP</li> <li>Bad: my-app-dist/index.html (nested path inside the ZIP)</li> </ul> <p>To Publish via Admin Portal Contact the Adminstrator of the system.</p>"},{"location":"microapp-developer/getting-started/#local-development-tips","title":"Local development tips","text":"<ul> <li>Iterate UI in the browser with the bridge polyfill; package/upload when you need to test real bridge flows on device.</li> <li>If your API requires auth, use <code>requestToken()</code> from the host when running inside the app; in browser preview, use a test token or mock responses, but never bundle tokens with the app.</li> <li>Keep CORS minimal; ensure your APIs are reachable from the device running the Super App.</li> </ul>"},{"location":"microapp-developer/getting-started/#security-guidance-important","title":"Security guidance (important)","text":"<ul> <li>Tokens may expire or be revoked at any time\u2014always request fresh tokens when needed rather than caching them long-term. Follow least-privilege: request only what you need.</li> <li>Avoid storing long\u2011lived secrets in plain text inside the micro\u2011app. Use the Super App\u2019s token exchange (<code>requestToken</code>) which returns a token scoped for the micro\u2011app.</li> <li>Validate any sensitive operations on the backend; do not rely on client-side checks alone.</li> </ul>"},{"location":"microapp-developer/getting-started/#testing-and-debugging","title":"Testing and debugging","text":"<ul> <li>If a bridge request hangs, check native logs to confirm the handler ran and the promise was resolved/rejected.</li> </ul>"},{"location":"microapp-developer/getting-started/#prepublish-checklist","title":"Pre\u2011publish checklist","text":"<ul> <li> <code>microapp.json</code> present at ZIP root and valid</li> <li> appId is unique and URL\u2011safe</li> <li> version/build updated (build strictly increases)</li> <li> icon/banner reachable (HTTPS)</li> <li> bridge calls guarded for browser preview</li> <li> no secrets committed in source or shipped assets</li> </ul>"},{"location":"microapp-developer/getting-started/#common-pitfalls","title":"Common pitfalls","text":"<ul> <li>Calling <code>window.nativebridge.requestXxx</code> without guarding for existence when previewing in a normal browser will throw. Always detect <code>window.nativebridge</code>.</li> <li>Expect Promise rejections. Wrap in try/catch.</li> </ul>"},{"location":"microapp-developer/push-notifications/","title":"Push Notifications Guide","text":"<p>Learn how to send push notifications to users from your microapp backend.</p>"},{"location":"microapp-developer/push-notifications/#overview","title":"Overview","text":"<p>The SuperApp provides a notification service that allows microapp backends to send push notifications to users. The service uses OAuth2 Client Credentials flow for authentication.</p>"},{"location":"microapp-developer/push-notifications/#prerequisites","title":"Prerequisites","text":"<p>Before you can send notifications, you need:</p> <ol> <li>OAuth2 Credentials - Contact the SuperApp admin to register your microapp</li> <li>Backend Service - A server-side application (never send from client-side)</li> <li>HTTPS Endpoint - SuperApp notification API endpoint</li> </ol>"},{"location":"microapp-developer/push-notifications/#authentication-flow","title":"Authentication Flow","text":""},{"location":"microapp-developer/push-notifications/#step-1-obtain-credentials","title":"Step 1: Obtain Credentials","text":"<p>Contact the SuperApp administrator to register your microapp and receive:</p> <ul> <li><code>client_id</code> - Your microapp identifier</li> <li><code>client_secret</code> - Secret key for authentication</li> </ul> <p>Security Warning</p> <p>Never expose your <code>client_secret</code> in:</p> <ul> <li>Client-side code</li> <li>Public repositories</li> <li>Browser applications</li> <li>Mobile app code</li> </ul> <p>Always use server-to-server authentication only!</p>"},{"location":"microapp-developer/push-notifications/#step-2-request-access-token","title":"Step 2: Request Access Token","text":"<p>Exchange your credentials for a JWT access token.</p> <p>Endpoint: <code>POST /oauth/token</code> (Public - No authentication required)</p> <pre><code>curl -X POST https://api.superapp.com/oauth/token \\\n    -H \"Content-Type: application/x-www-form-urlencoded\" \\\n    -d \"grant_type=client_credentials\" \\\n    -d \"client_id=YOUR_CLIENT_ID\" \\\n    -d \"client_secret=YOUR_CLIENT_SECRET\"\n</code></pre> <p>Response:</p> <pre><code>{\n  \"access_token\": \"eyJhbGciOiJSUzI1Ni...\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 7200\n}\n</code></pre> <p>Token Properties:</p> <ul> <li>Valid for 2 hours (7200 seconds)</li> <li>Should be cached and reused</li> <li>Request a new token before expiry</li> </ul>"},{"location":"microapp-developer/push-notifications/#sending-notifications","title":"Sending Notifications","text":""},{"location":"microapp-developer/push-notifications/#step-3-send-push-notification","title":"Step 3: Send Push Notification","text":"<p>Use the access token to send notifications to users.</p> <p>Endpoint: <code>POST /api/v1/services/notifications/send</code> (Requires Bearer token)</p> <pre><code>curl -X POST https://api.superapp.com/api/v1/services/notifications/send \\\n    -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\n    \"user_emails\": [\"user@example.com\"],\n    \"title\": \"Order Update\",\n    \"body\": \"Your order #12345 has shipped!\",\n    \"data\": {\n        \"orderId\": \"12345\",\n        \"action\": \"view_order\"\n    }'\n</code></pre>"},{"location":"microapp-developer/push-notifications/#request-payload","title":"Request Payload","text":"Field Type Required Description <code>user_emails</code> string[] Yes Array of user email addresses <code>title</code> string Yes Notification title <code>body</code> string Yes Notification body text <code>data</code> object No Custom key-value pairs for deep linking"},{"location":"microapp-developer/push-notifications/#response","title":"Response","text":"<pre><code>{\n  \"success\": 2,\n  \"failed\": 0,\n  \"message\": \"Notifications sent successfully\"\n}\n</code></pre>"},{"location":"microapp-developer/push-notifications/#best-practices","title":"Best Practices","text":""},{"location":"microapp-developer/push-notifications/#1-token-management","title":"1. Token Management","text":"<p>\u2705 Do: - Cache tokens and reuse until expiry - Refresh tokens before they expire - Implement retry logic for 401 errors</p> <p>\u274c Don't: - Request a new token for every notification - Store tokens in client-side code - Hardcode credentials</p>"},{"location":"microapp-developer/push-notifications/#2-security","title":"2. Security","text":"<p>\u2705 Do: - Use environment variables for credentials - Always use HTTPS - Use Basic Auth header for production - Implement rate limiting</p> <p>\u274c Don't: - Commit secrets to version control - Send credentials in URL parameters - Expose API in client-side code</p>"},{"location":"microapp-developer/push-notifications/#3-error-handling","title":"3. Error Handling","text":"<pre><code>async function sendWithRetry(notifier, userEmails, title, body, data, maxRetries = 3) {\n  for (let i = 0; i &lt; maxRetries; i++) {\n    try {\n      return await notifier.sendNotification(userEmails, title, body, data);\n    } catch (error) {\n      if (i === maxRetries - 1) throw error;\n\n      // Exponential backoff\n      await new Promise(resolve =&gt; setTimeout(resolve, Math.pow(2, i) * 1000));\n    }\n  }\n}\n</code></pre>"},{"location":"microapp-developer/push-notifications/#4-notification-content","title":"4. Notification Content","text":"<p>\u2705 Do: - Keep titles under 50 characters - Keep body under 200 characters - Use meaningful data for deep linking - Test on actual devices</p> <p>\u274c Don't: - Send HTML in notifications - Include sensitive data - Send too frequently</p>"},{"location":"microapp-developer/push-notifications/#api-reference","title":"API Reference","text":""},{"location":"microapp-developer/push-notifications/#endpoints","title":"Endpoints","text":"Endpoint Method Auth Purpose <code>/oauth/token</code> POST None Get access token <code>/api/v1/services/notifications/send</code> POST Bearer Send notification"},{"location":"microapp-developer/push-notifications/#error-codes","title":"Error Codes","text":"Code Description Solution 400 Bad Request Check payload format 401 Unauthorized Token expired or invalid 403 Forbidden Invalid credentials 429 Too Many Requests Implement rate limiting 500 Server Error Retry with backoff"},{"location":"microapp-developer/push-notifications/#troubleshooting","title":"Troubleshooting","text":""},{"location":"microapp-developer/push-notifications/#token-issues","title":"Token Issues","text":"<p>Problem: Getting 401 Unauthorized</p> <p>Solutions: - Verify your <code>client_id</code> and <code>client_secret</code> - Check if token has expired - Ensure you're using Bearer authentication - Contact admin to verify your client is active</p>"},{"location":"microapp-developer/push-notifications/#notification-not-received","title":"Notification Not Received","text":"<p>Possible causes: - User hasn't installed the SuperApp - User has disabled notifications - Invalid user email - Device token not registered</p> <p>Debug steps: 1. Check API response for success/failed counts 2. Verify user email is correct 3. Test with a known working user 4. Check device notification settings</p>"},{"location":"microapp-developer/push-notifications/#additional-resources","title":"Additional Resources","text":"<ul> <li>OAuth2 Client Credentials Flow</li> <li>Firebase Cloud Messaging</li> <li>API Reference</li> </ul>"},{"location":"superapp-developer/backend-core/","title":"Core Service - Developer Guide","text":""},{"location":"superapp-developer/backend-core/#overview","title":"Overview","text":"<p>The Core Service is the main backend API for the Super App Project. It handles all business logic including microapp management, user configurations, push notifications, and file storage.</p> <p>Key Responsibilities:</p> <ul> <li>Microapp CRUD operations and versioning</li> <li>User configuration management</li> <li>Push notifications via Firebase Cloud Messaging</li> <li>File storage (database-based)</li> <li>Authentication and authorization (dual IDP support)</li> <li>Device token management</li> </ul> <p>Tech Stack:</p> <ul> <li>Language: Go 1.25.4</li> <li>HTTP Router: Chi v5</li> <li>ORM: GORM</li> <li>Database: MySQL 8.0+</li> <li>Authentication: JWT (Asgardeo + Internal IDP)</li> <li>Push Notifications: Firebase Admin SDK</li> </ul>"},{"location":"superapp-developer/backend-core/#prerequisites","title":"Prerequisites","text":""},{"location":"superapp-developer/backend-core/#required-software","title":"Required Software","text":"<ul> <li>Go: 1.25.4 or higher (Download)</li> <li>MySQL: 8.0 or higher (Download)</li> <li>Git: For version control</li> <li>Firebase Project: With Admin SDK credentials</li> </ul>"},{"location":"superapp-developer/backend-core/#optional-tools","title":"Optional Tools","text":"<ul> <li>Air: For hot reload during development</li> <li>Postman/Insomnia: For API testing</li> <li>MySQL Workbench: For database management</li> </ul>"},{"location":"superapp-developer/backend-core/#environment-setup","title":"Environment Setup","text":""},{"location":"superapp-developer/backend-core/#1-clone-and-navigate","title":"1. Clone and Navigate","text":"<pre><code>cd /path/to/superapp-mobile/services/core\n</code></pre>"},{"location":"superapp-developer/backend-core/#2-install-dependencies","title":"2. Install Dependencies","text":"<pre><code>go mod download\n</code></pre>"},{"location":"superapp-developer/backend-core/#3-configure-environment-variables","title":"3. Configure Environment Variables","text":"<pre><code># Copy example environment file\ncp .env.example .env\n\n# Edit .env with your settings\nnano .env  # or use your preferred editor\n</code></pre>"},{"location":"superapp-developer/backend-core/#4-environment-variables-reference","title":"4. Environment Variables Reference","text":"<pre><code># Database Configuration\nDB_USER=root                      # MySQL username\nDB_PASSWORD=your_password         # MySQL password\nDB_HOST=localhost                 # Database host\nDB_PORT=3306                      # Database port\nDB_NAME=superapp-database         # Database name\nDB_MAX_OPEN_CONNS=25              # Max open connections\nDB_MAX_IDLE_CONNS=5               # Max idle connections\nDB_CONN_MAX_LIFETIME_MIN=30       # Connection max lifetime (minutes)\nDB_CONN_MAX_IDLE_TIME_MIN=5       # Connection max idle time (minutes)\nDB_CONNECT_RETRIES=5              # Connection retry attempts\n\n# Server Configuration\nSERVER_PORT=9090                  # HTTP server port\n\n# External IDP (Asgardeo) - for user authentication\nEXTERNAL_IDP_JWKS_URL=https://api.asgardeo.io/t/your-org/oauth2/jwks\nEXTERNAL_IDP_ISSUER=https://api.asgardeo.io/t/your-org/oauth2/token\n\n# Internal IDP (Token Service) - for service-to-service auth\nINTERNAL_IDP_BASE_URL=http://localhost:8081\nINTERNAL_IDP_ISSUER=superapp\nINTERNAL_IDP_AUDIENCE=superapp-api\n\n# Service Configuration\nUSER_SERVICE_TYPE=db              # User service type (db)\nFILE_SERVICE_TYPE=db              # File service type (db)\n\n# Firebase Configuration\nFIREBASE_CREDENTIALS_PATH=./path/to/firebase-admin-key.json\n</code></pre> <p>Firebase Setup</p> <p>Download your Firebase Admin SDK JSON file from the Firebase Console (Project Settings \u2192 Service Accounts \u2192 Generate New Private Key) and update the path in <code>.env</code>.</p>"},{"location":"superapp-developer/backend-core/#database-setup","title":"Database Setup","text":""},{"location":"superapp-developer/backend-core/#1-create-database","title":"1. Create Database","text":"<pre><code># Connect to MySQL\nmysql -u root -p\n\n# Create database\nCREATE DATABASE superapp-database CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n\n# Verify\nSHOW DATABASES;\n\n# Exit\nexit\n</code></pre>"},{"location":"superapp-developer/backend-core/#2-run-migrations","title":"2. Run Migrations","text":"<pre><code># From services/core directory\nmysql -u root -p superapp-database &lt; migrations/001_init_schema.sql\n</code></pre>"},{"location":"superapp-developer/backend-core/#3-verify-tables","title":"3. Verify Tables","text":"<pre><code>mysql -u root -p superapp-database\n\nSHOW TABLES;\n# Expected tables:\n# - micro_apps\n# - micro_app_versions\n# - micro_app_roles\n# - micro_app_configs\n# - device_tokens\n# - notification_logs\n# - micro_apps_storage\n\nexit\n</code></pre>"},{"location":"superapp-developer/backend-core/#running-locally","title":"Running Locally","text":""},{"location":"superapp-developer/backend-core/#method-1-direct-run","title":"Method 1: Direct Run","text":"<pre><code># From services/core directory\ngo run cmd/server/main.go\n</code></pre> <p>Output:</p> <pre><code>2025/12/03 20:00:00 INFO Starting server port=9090\n</code></pre>"},{"location":"superapp-developer/backend-core/#method-2-with-hot-reload-recommended","title":"Method 2: With Hot Reload (Recommended)","text":"<pre><code># Install air if not already installed\ngo install github.com/air-verse/air@latest\n\n# Run with hot reload\nair\n</code></pre> <p>Air will watch for file changes and automatically rebuild and restart the server.</p>"},{"location":"superapp-developer/backend-core/#method-3-build-and-run","title":"Method 3: Build and Run","text":"<pre><code># Build binary\ngo build -o bin/core-service cmd/server/main.go\n\n# Run binary\n./bin/core-service\n</code></pre>"},{"location":"superapp-developer/backend-core/#building-for-production","title":"Building for Production","text":""},{"location":"superapp-developer/backend-core/#1-build-optimized-binary","title":"1. Build Optimized Binary","text":"<pre><code># Build with optimizations\nCGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build \\\n  -ldflags=\"-w -s\" \\\n  -o bin/core-service \\\n  cmd/server/main.go\n</code></pre> <p>Flags explained:</p> <ul> <li><code>CGO_ENABLED=0</code> - Disable CGO for static binary</li> <li><code>GOOS=linux</code> - Target OS</li> <li><code>GOARCH=amd64</code> - Target architecture</li> <li><code>-ldflags=\"-w -s\"</code> - Strip debug info (smaller binary)</li> </ul>"},{"location":"superapp-developer/backend-core/#2-docker-build","title":"2. Docker Build","text":"<pre><code># Example Dockerfile\nFROM golang:1.25.4-alpine AS builder\nWORKDIR /app\nCOPY go.mod go.sum ./\nRUN go mod download\nCOPY . .\nRUN CGO_ENABLED=0 go build -ldflags=\"-w -s\" -o core-service cmd/server/main.go\n\nFROM alpine:latest\nRUN apk --no-cache add ca-certificates\nWORKDIR /root/\nCOPY --from=builder /app/core-service .\nCOPY --from=builder /app/migrations ./migrations\nEXPOSE 9090\nCMD [\"./core-service\"]\n</code></pre> <p>Build and run:</p> <pre><code>docker build -t core-service:latest .\ndocker run -p 9090:9090 --env-file .env core-service:latest\n</code></pre>"},{"location":"superapp-developer/backend-core/#testing","title":"Testing","text":""},{"location":"superapp-developer/backend-core/#run-all-tests","title":"Run All Tests","text":"<pre><code># Run all tests\ngo test ./...\n\n# Run with verbose output\ngo test -v ./...\n\n# Run with coverage\ngo test -cover ./...\n\n# Generate coverage report\ngo test -coverprofile=coverage.out ./...\ngo tool cover -html=coverage.out\n</code></pre>"},{"location":"superapp-developer/backend-core/#run-specific-package-tests","title":"Run Specific Package Tests","text":"<pre><code># Test handlers\ngo test ./internal/api/v1/handler/...\n\n# Test services\ngo test ./internal/services/...\n\n# Test auth middleware\ngo test ./internal/auth/...\n</code></pre>"},{"location":"superapp-developer/backend-core/#additional-resources","title":"Additional Resources","text":"<ul> <li>Go Documentation</li> <li>Chi Router</li> <li>GORM Documentation</li> <li>Firebase Admin SDK</li> <li>Swagger/OpenAPI</li> </ul>"},{"location":"superapp-developer/backend-token-service/","title":"Token Issuer Service","text":"<p>A secure, lightweight OAuth2-compliant token issuing service for the SuperApp ecosystem. This service handles JWT token generation and signing for service-to-service authentication between microapp backends and the SuperApp platform.</p>"},{"location":"superapp-developer/backend-token-service/#overview","title":"Overview","text":"<p>The Token Issuer Service is a critical component of the SuperApp microservices architecture. It provides:</p> <ul> <li>Service Authentication: Issues JWT tokens for microapp backends to authenticate with SuperApp APIs</li> <li>User Context Tokens: Generates tokens that carry user identity for microapp frontends</li> <li>JWKS Publishing: Exposes public keys for token validation by downstream services</li> </ul>"},{"location":"superapp-developer/backend-token-service/#what-this-service-does","title":"What This Service Does","text":"Function Description Token Issuance Signs and issues JWTs using RS256 algorithm Client Credentials Grant OAuth2 flow for service-to-service auth User Context Grant Custom flow for user-scoped microapp tokens JWKS Publishing Serves public keys in standard JWKS format"},{"location":"superapp-developer/backend-token-service/#what-this-service-does-not-do","title":"What This Service Does NOT Do","text":"Function Where It's Handled User Authentication External IDP (Ex:Asgardeo) User Identity Management External IDP (Ex:Asgardeo) Token Validation superapp-backend / Microapp backends Session Management Not applicable (stateless tokens)"},{"location":"superapp-developer/backend-token-service/#features","title":"Features","text":""},{"location":"superapp-developer/backend-token-service/#core-features","title":"Core Features","text":"<ul> <li>OAuth2 Client Credentials Grant - Standard OAuth2 flow for services</li> <li>Custom User Context Grant - Tokens with embedded user identity</li> <li>RS256 JWT Signing - Industry-standard asymmetric signing</li> <li>JWKS Publishing - Standard endpoint for public key distribution</li> <li>Multi-Key Support - Load and manage multiple signing keys</li> <li>Zero-Downtime Key Rotation - Rotate keys without service restart</li> </ul>"},{"location":"superapp-developer/backend-token-service/#security-features","title":"Security Features","text":"<ul> <li>Hashed Client Secrets - Secrets stored as SHA256 hashes</li> <li>Request Body Limits - Protection against large payload attacks</li> <li>Structured Logging - JSON logs with <code>slog</code> for audit trails</li> <li>Key ID (kid) in JWT Header - Enables key identification for validation</li> </ul>"},{"location":"superapp-developer/backend-token-service/#getting-started","title":"Getting Started","text":""},{"location":"superapp-developer/backend-token-service/#prerequisites","title":"Prerequisites","text":"<ul> <li>Go 1.21 or later</li> <li>MySQL 8.0+ (or compatible)</li> <li>OpenSSL (for key generation)</li> </ul>"},{"location":"superapp-developer/backend-token-service/#installation","title":"Installation","text":"<pre><code># Clone the repository\ngit clone &lt;repository-url&gt;\ncd superapp-mobile/token-issure-service\n\n# Install dependencies\ngo mod download\n\n# Generate development keys (first time only)\n./scripts/generate-keys.sh \"dev-key-example\" \"./keys/dev\"\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#configuration","title":"Configuration","text":"<p>Copy the example environment file and configure:</p> <pre><code>cp .env.example .env\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#environment-variables","title":"Environment Variables","text":"Variable Description Default <code>PORT</code> Server port <code>8081</code> <code>DB_USER</code> Database username <code>root</code> <code>DB_PASSWORD</code> Database password <code>password</code> <code>DB_HOST</code> Database host <code>127.0.0.1</code> <code>DB_PORT</code> Database port <code>3306</code> <code>DB_NAME</code> Database name <code>superapp</code> <code>TOKEN_EXPIRY_SECONDS</code> Token validity period <code>3600</code>"},{"location":"superapp-developer/backend-token-service/#key-configuration-choose-one","title":"Key Configuration (Choose One)","text":"<p>Option 1: Single Key Mode (Simple, backward compatible)</p> <pre><code>PRIVATE_KEY_PATH=./keys/dev/dev-key-example_private.pem\nPUBLIC_KEY_PATH=./keys/dev/dev-key-example_public.pem\nJWKS_PATH=./keys/dev/dev-key-example_jwks.json\n</code></pre> <p>Option 2: Directory Mode (Recommended for production)</p> <pre><code>KEYS_DIR=./keys/dev\nACTIVE_KEY_ID=dev-key-example\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#running-the-service","title":"Running the Service","text":"<pre><code># Development\ngo run cmd/server/main.go\n\n# Build and run\ngo build -o bin/token-issuer cmd/server/main.go\n./bin/token-issuer\n</code></pre> <p>The service will start on <code>http://localhost:8081</code> (or configured port).</p>"},{"location":"superapp-developer/backend-token-service/#api-reference","title":"API Reference","text":""},{"location":"superapp-developer/backend-token-service/#hot-key-reload-zero-downtime-rotation","title":"Hot Key Reload (Zero-Downtime Rotation)","text":"<p>You can rotate keys without restarting the service by using the reload endpoint. This is useful for production environments where zero downtime is required.</p> <ol> <li>Generate new keys in the keys directory (e.g., <code>key-2_private.pem</code>, <code>key-2_public.pem</code>).</li> <li>Trigger reload:    <pre><code>curl -X POST http://localhost:8081/admin/reload-keys\n</code></pre></li> <li>Verify: The service will load the new keys and add them to the JWKS.</li> <li>Update Active Key: Set the new key as active to start signing tokens with it:    <pre><code>curl -X POST \"http://localhost:8081/admin/active-key?key_id=key-2\"\n</code></pre>    Both keys remain valid for verification, allowing seamless rotation without invalidating existing tokens.</li> </ol> <p>Note: The <code>admin/reload-keys</code> endpoint re-scans the directory specified by <code>KEYS_DIR</code>. Ensure the new key files are present before calling it.</p>"},{"location":"superapp-developer/backend-token-service/#1-oauth-token-endpoint","title":"1. OAuth Token Endpoint","text":"<p>Issues tokens for service-to-service authentication using OAuth2 Client Credentials grant.</p> <p>Endpoint: <code>POST /oauth/token</code></p> <p>Content Type: <code>application/x-www-form-urlencoded</code></p>"},{"location":"superapp-developer/backend-token-service/#request-recommended-basic-auth-header","title":"Request (Recommended - Basic Auth Header)","text":"<pre><code>curl -X POST http://localhost:8081/oauth/token \\\n  -u \"microapp-news:your-secret-here\" \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"grant_type=client_credentials\"\n</code></pre> <p>This uses HTTP Basic Authentication where:</p> <ul> <li><code>client_id</code> \u2192 Basic Auth username</li> <li><code>client_secret</code> \u2192 Basic Auth password</li> </ul> <p>The <code>-u</code> flag in curl automatically encodes credentials as <code>Authorization: Basic base64(client_id:client_secret)</code></p>"},{"location":"superapp-developer/backend-token-service/#alternative-form-data-not-recommended","title":"Alternative: Form Data (Not Recommended)","text":"<pre><code>curl -X POST http://localhost:8081/oauth/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"grant_type=client_credentials\" \\\n  -d \"client_id=microapp-news\" \\\n  -d \"client_secret=your-secret-here\"\n</code></pre> <p>\u26a0\ufe0f Sending secrets in form body is less secure than Basic Auth header</p>"},{"location":"superapp-developer/backend-token-service/#response-success-200","title":"Response (Success - 200)","text":"<pre><code>{\n  \"access_token\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImRldi1rZXktZXhhbXBsZSIsInR5cCI6IkpXVCJ9...\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600\n}\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#response-error-400401","title":"Response (Error - 400/401)","text":"<pre><code>{\n  \"error\": \"invalid_client\",\n  \"error_description\": \"client_id and client_secret are required\"\n}\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#error-codes","title":"Error Codes","text":"Code Description <code>invalid_request</code> Malformed request <code>invalid_client</code> Client not found or wrong credentials <code>unsupported_grant_type</code> Grant type not supported <code>server_error</code> Internal server error"},{"location":"superapp-developer/backend-token-service/#2-create-oauth-client-endpoint","title":"2. Create OAuth Client Endpoint","text":"<p>Creates a new OAuth2 client with a securely generated client secret. This endpoint is used to register new microapp backends that need to authenticate with the SuperApp platform.</p> <p>Endpoint: <code>POST /oauth/clients</code></p> <p>Content Type: <code>application/json</code></p>"},{"location":"superapp-developer/backend-token-service/#request","title":"Request","text":"<pre><code>curl -X POST http://localhost:8081/oauth/clients \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"client_id\": \"microapp-weather\",\n    \"name\": \"Weather Microapp Backend\",\n    \"scopes\": \"read write notifications:send\"\n  }'\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#request-body-parameters","title":"Request Body Parameters","text":"Parameter Type Required Description <code>client_id</code> string Yes Unique identifier for the OAuth client (also serves as microapp ID) <code>name</code> string Yes Human-readable name for the client <code>scopes</code> string No Comma-separated list of scopes (e.g., \"read write admin\")"},{"location":"superapp-developer/backend-token-service/#response-success-201-created","title":"Response (Success - 201 Created)","text":"<pre><code>{\n  \"client_id\": \"microapp-weather\",\n  \"client_secret\": \"aB3dE5fG7hI9jK1lM3nO5pQ7rS9tU1vW\",\n  \"name\": \"Weather Microapp Backend\",\n  \"scopes\": \"read write notifications:send\",\n  \"is_active\": true\n}\n</code></pre> <p>\u26a0\ufe0f Important: The <code>client_secret</code> is only returned once during client creation. Store it securely as it cannot be retrieved later.</p>"},{"location":"superapp-developer/backend-token-service/#response-error-400-bad-request","title":"Response (Error - 400 Bad Request)","text":"<pre><code>{\n  \"error\": \"invalid_request\",\n  \"error_description\": \"client_id is required\"\n}\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#response-error-409-conflict","title":"Response (Error - 409 Conflict)","text":"<pre><code>{\n  \"error\": \"invalid_request\",\n  \"error_description\": \"client_id already exists\"\n}\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#security-features_1","title":"Security Features","text":"<ul> <li>Secure Generation: Client secrets are generated using cryptographically secure random number generation (<code>crypto/rand</code>)</li> <li>32-Character Length: Secrets contain 32 alphanumeric characters (a-z, A-Z, 0-9)</li> <li>Hashed Storage: Secrets are hashed using SHA-256 before being stored in the database</li> <li>One-Time Visibility: The plain text secret is only returned once and cannot be retrieved later</li> </ul>"},{"location":"superapp-developer/backend-token-service/#3-user-context-token-endpoint","title":"3. User Context Token Endpoint","text":"<p>Generates tokens with embedded user identity for microapp frontends. This endpoint is called by go-backend during token exchange.</p> <p>Endpoint: <code>POST /oauth/token/user</code></p> <p>Content Type: <code>application/x-www-form-urlencoded</code></p>"},{"location":"superapp-developer/backend-token-service/#request_1","title":"Request","text":"<pre><code>curl -X POST http://localhost:8081/oauth/token/user \\\n  -d \"grant_type=user_context\" \\\n  -d \"user_email=user@example.com\" \\\n  -d \"microapp_id=microapp-news\" \\\n  -d \"scope=read write\"\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#response-success-200_1","title":"Response (Success - 200)","text":"<pre><code>{\n  \"access_token\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImRldi1rZXktZXhhbXBsZSIsInR5cCI6IkpXVCJ9...\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600\n}\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#token-claims","title":"Token Claims","text":"<p>The generated token includes:</p> <pre><code>{\n  \"iss\": \"superapp-idp\",\n  \"sub\": \"microapp-news\",\n  \"aud\": [\"superapp-api\"],\n  \"exp\": 1701648000,\n  \"iat\": 1701644400,\n  \"nbf\": 1701644400,\n  \"email\": \"user@example.com\",\n  \"scope\": \"read write\"\n}\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#4-jwks-endpoint","title":"4. JWKS Endpoint","text":"<p>Serves the JSON Web Key Set containing public keys for token validation.</p> <p>Endpoint: <code>GET /.well-known/jwks.json</code></p>"},{"location":"superapp-developer/backend-token-service/#response-200","title":"Response (200)","text":"<pre><code>{\n  \"keys\": [\n    {\n      \"kty\": \"RSA\",\n      \"use\": \"sig\",\n      \"kid\": \"dev-key-example\",\n      \"n\": \"xOw3Yt...\",\n      \"e\": \"AQAB\",\n      \"alg\": \"RS256\"\n    },\n    {\n      \"kty\": \"RSA\",\n      \"use\": \"sig\",\n      \"kid\": \"dev-key-2\",\n      \"n\": \"yPx4Zu...\",\n      \"e\": \"AQAB\",\n      \"alg\": \"RS256\"\n    }\n  ]\n}\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#usage-in-token-validation","title":"Usage in Token Validation","text":"<p>Microapp backends should:</p> <ol> <li>Fetch JWKS from <code>go-backend/.well-known/jwks.json</code> (proxied)</li> <li>Cache the JWKS with periodic refresh (recommended: 1 hour)</li> <li>Use the <code>kid</code> header in incoming JWTs to select the correct key</li> <li>Validate the token signature using the matching public key</li> </ol>"},{"location":"superapp-developer/backend-token-service/#token-structure","title":"Token Structure","text":""},{"location":"superapp-developer/backend-token-service/#jwt-header","title":"JWT Header","text":"<pre><code>{\n  \"alg\": \"RS256\",\n  \"kid\": \"dev-key-example\",\n  \"typ\": \"JWT\"\n}\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#service-token-claims-client-credentials","title":"Service Token Claims (Client Credentials)","text":"<pre><code>{\n  \"iss\": \"superapp-idp\",\n  \"sub\": \"microapp-news\",\n  \"aud\": [\"superapp-api\"],\n  \"exp\": 1701648000,\n  \"iat\": 1701644400,\n  \"nbf\": 1701644400,\n  \"scope\": \"notifications:send users:read\"\n}\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#user-context-token-claims","title":"User Context Token Claims","text":"<pre><code>{\n  \"iss\": \"superapp-idp\",\n  \"sub\": \"user@example.com\",\n  \"aud\": [\"microapp-news\"],\n  \"exp\": 1701648000,\n  \"iat\": 1701644400,\n  \"nbf\": 1701644400,\n  \"microapp_id\": \"microapp-news\",\n  \"scope\": \"read write\"\n}\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#claim-descriptions","title":"Claim Descriptions","text":""},{"location":"superapp-developer/backend-token-service/#service-token-client-credentials","title":"Service Token (Client Credentials)","text":"Claim Description <code>iss</code> Issuer - always <code>superapp-idp</code> <code>sub</code> Subject - the microapp/client ID <code>aud</code> Audience - <code>superapp-api</code> <code>exp</code> Expiration time (Unix timestamp) <code>iat</code> Issued at (Unix timestamp) <code>nbf</code> Not valid before (Unix timestamp) <code>scope</code> Space-separated list of scopes"},{"location":"superapp-developer/backend-token-service/#user-context-token","title":"User Context Token","text":"Claim Description <code>iss</code> Issuer - always <code>superapp-idp</code> <code>sub</code> Subject - the user's email <code>aud</code> Audience - the target microapp ID <code>exp</code> Expiration time (Unix timestamp) <code>iat</code> Issued at (Unix timestamp) <code>nbf</code> Not valid before (Unix timestamp) <code>microapp_id</code> The microapp this token is valid for <code>scope</code> Space-separated list of scopes"},{"location":"superapp-developer/backend-token-service/#key-management","title":"Key Management","text":""},{"location":"superapp-developer/backend-token-service/#single-key-mode","title":"Single Key Mode","text":"<p>For simple deployments or development:</p> <pre><code># Directory structure\nkeys/\n\u2514\u2500\u2500 dev/\n    \u251c\u2500\u2500 dev-key-example_private.pem  # Keep secure!\n    \u251c\u2500\u2500 dev-key-example_public.pem\n    \u2514\u2500\u2500 dev-key-example_jwks.json\n\n# Configuration\nPRIVATE_KEY_PATH=./keys/dev/dev-key-example_private.pem\nPUBLIC_KEY_PATH=./keys/dev/dev-key-example_public.pem\nJWKS_PATH=./keys/dev/dev-key-example_jwks.json\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#directory-mode-multi-key","title":"Directory Mode (Multi-Key)","text":"<p>For production with key rotation support:</p> <pre><code># Directory structure\nkeys/\n\u2514\u2500\u2500 prod/\n    \u251c\u2500\u2500 prod-key-2024-q1_private.pem\n    \u251c\u2500\u2500 prod-key-2024-q1_public.pem\n    \u251c\u2500\u2500 prod-key-2024-q2_private.pem  # New key for rotation\n    \u2514\u2500\u2500 prod-key-2024-q2_public.pem\n\n# Configuration\nKEYS_DIR=./keys/prod\nACTIVE_KEY_ID=prod-key-2024-q1  # Currently signing key\n</code></pre> <p>How it works:</p> <ul> <li>All keys in the directory are loaded on startup</li> <li>JWKS contains all public keys (enables validation of any key)</li> <li>Only the <code>ACTIVE_KEY_ID</code> is used for signing new tokens</li> <li>Old tokens remain valid until they expire</li> </ul>"},{"location":"superapp-developer/backend-token-service/#key-rotation","title":"Key Rotation","text":"<p>See https://github.com/LSFLK/superapp-mobile/blob/main/backend-services/token-service/docs/KEY_ROTATION.md for detailed instructions.</p> <p>Quick Overview:</p> <pre><code># 1. Generate new key\n./scripts/generate-keys.sh \"prod-key-2024-q2\" \"./keys/prod\" 4096\n\n# 2. Reload keys (no restart needed)\ncurl -X POST http://localhost:8081/admin/reload-keys\n\n# 3. Set new key as active\ncurl -X POST \"http://localhost:8081/admin/active-key?key_id=prod-key-2024-q2\"\n\n# 4. Wait for old tokens to expire, then remove old key\n</code></pre>"},{"location":"superapp-developer/backend-token-service/#security-considerations","title":"Security Considerations","text":""},{"location":"superapp-developer/backend-token-service/#production-checklist","title":"Production Checklist","text":"<ul> <li> Never commit private keys - Add <code>*.pem</code> to <code>.gitignore</code></li> <li> Use 4096-bit keys - More secure than 2048-bit</li> <li> Store secrets securely - Use AWS Secrets Manager, Vault, etc.</li> <li> Rotate keys regularly - Every 90 days recommended</li> <li> Use different keys per environment - dev/staging/prod</li> <li> Enable TLS - Run behind HTTPS proxy in production</li> <li> Limit token expiry - Default 1 hour, adjust as needed</li> <li> Monitor token issuance - Set up alerts for anomalies</li> </ul>"},{"location":"superapp-developer/backend-token-service/#client-secret-storage","title":"Client Secret Storage","text":"<p>Client secrets are stored as SHA256 hashes:</p> <pre><code>// Registration (admin process)\nhash := sha256.Sum256([]byte(rawSecret))\nstoredHash := hex.EncodeToString(hash[:])\n\n// Validation (during token request)\nhash := sha256.Sum256([]byte(providedSecret))\nif hex.EncodeToString(hash[:]) != storedHash {\n    return error\n}\n</code></pre>"},{"location":"superapp-developer/deployment/","title":"SuperApp Production Deployment Guide","text":"<p>Follow these phases in order. Each phase links to detailed component documentation.</p>"},{"location":"superapp-developer/deployment/#deployment-overview","title":"Deployment Overview","text":"<pre><code>graph TD\n    A[Phase 1: Prerequisites] --&gt; B[Phase 2: Database]\n    B --&gt; C[Phase 3: Token Service]\n    C --&gt; D[Phase 4: Core Service]\n    D --&gt; E[Phase 5: Admin Portal]\n    E --&gt; F[Phase 6: Mobile App]</code></pre>"},{"location":"superapp-developer/deployment/#phase-1-prerequisites","title":"Phase 1: Prerequisites","text":""},{"location":"superapp-developer/deployment/#11-infrastructure-setup","title":"1.1 Infrastructure Setup","text":"<p>Minimum Requirements:</p> <ul> <li>CPU: 2 cores | RAM: 4 GB | Storage: 20 GB</li> <li>OS: Ubuntu 20.04+ or equivalent</li> <li>Network access between services</li> </ul>"},{"location":"superapp-developer/deployment/#12-setup-external-identity-provider-ex-asgardeo","title":"1.2 Setup External Identity Provider (Ex: Asgardeo)","text":"<p>Create an organization for the project</p> <p>Create TWO OAuth2 applications:</p> <p>Application 1: superapp-mobile (Mobile/SPA application)</p> <ul> <li>Type: Mobile/Single Page Application</li> <li>Grant: Authorization Code + PKCE</li> <li>Redirect URI: <code>&lt;your-schema&gt;://*</code></li> <li>Use for: Mobile app user authentication</li> </ul> <p>Application 2: superapp-admin (Web application)</p> <ul> <li>Type: Web Application</li> <li>Grant: Authorization Code</li> <li>Redirect URI: <code>https://admin.yourdomain.com/</code></li> <li>Use for: Admin portal authentication</li> <li>Important: Configure conditional authentication to restrict access to <code>superapp-admin</code> user group</li> </ul> <p>Save these for later:</p> <ul> <li>Client IDs for both apps</li> <li>Token endpoint URL</li> <li>Authorization endpoint URL</li> <li>JWKS URI</li> <li>Logout endpoint URL</li> </ul>"},{"location":"superapp-developer/deployment/#13-setup-firebase-project","title":"1.3 Setup Firebase Project","text":"<p>Required: Create Firebase project at console.firebase.google.com</p> <p>Steps:</p> <ol> <li>Create new project</li> <li>Add Android app \u2192 Download <code>google-services.json</code></li> <li>Add iOS app \u2192 Download <code>GoogleService-Info.plist</code></li> <li>Go to Project Settings \u2192 Service Accounts</li> <li>Generate new private key \u2192 Download Admin SDK JSON file (e.g., <code>firebase-admin-sdk-xxxxx.json</code>)</li> </ol> <p>Save these files securely - you'll need them in Phases 4 and 6.</p> <p>\ud83d\udcda Firebase Setup Guide</p>"},{"location":"superapp-developer/deployment/#14-ssl-certificates-production-only","title":"1.4 SSL Certificates (Production Only)","text":"<ul> <li>Obtain SSL certificates for your domains</li> <li>Recommended: Let's Encrypt (free)</li> </ul>"},{"location":"superapp-developer/deployment/#phase-2-database-setup","title":"Phase 2: Database Setup","text":"<p>Setup MySQL database:</p> <pre><code>CREATE DATABASE superapp_production\n  CHARACTER SET utf8mb4\n  COLLATE utf8mb4_unicode_ci;\n\nCREATE USER 'tokenservice'@'%' IDENTIFIED BY '&lt;STRONG_PASSWORD_1&gt;';\nCREATE USER 'coreservice'@'%' IDENTIFIED BY '&lt;STRONG_PASSWORD_2&gt;';\n\nGRANT ALL PRIVILEGES ON superapp_production.* TO 'tokenservice'@'%';\nGRANT ALL PRIVILEGES ON superapp_production.* TO 'coreservice'@'%';\n\nFLUSH PRIVILEGES;\n</code></pre> <p>Run migrations:</p> <p>See Backend (Core) - Database Setup</p>"},{"location":"superapp-developer/deployment/#phase-3-token-service-deployment","title":"Phase 3: Token Service Deployment","text":"<p>Deploy the internal OAuth2/JWT token issuer.</p>"},{"location":"superapp-developer/deployment/#31-generate-rsa-keys","title":"3.1 Generate RSA Keys","text":"<pre><code>cd backend-services/token-service\n\n# Generate production keys (4096-bit recommended)\n./scripts/generate-keys.sh \"prod-key-$(date +%Y-%m)\" \"./keys/prod\" 4096\n</code></pre> <p>\u26a0\ufe0f Security: Store private keys in a secrets manager (AWS Secrets Manager, Vault, etc.). Never commit to Git.</p>"},{"location":"superapp-developer/deployment/#32-configure-and-deploy","title":"3.2 Configure and Deploy","text":"<p>Follow: backend-token-service.md - Configuration &amp; Running</p> <p>Key environment variables:</p> <ul> <li><code>DB_USER=tokenservice</code></li> <li><code>DB_PASSWORD=&lt;STRONG_PASSWORD_1&gt;</code></li> <li><code>DB_NAME=superapp_production</code></li> <li><code>KEYS_DIR=./keys/prod</code></li> <li><code>ACTIVE_KEY_ID=prod-key-2024-12</code> (or your key ID)</li> </ul> <p>Verify deployment:</p> <pre><code>curl http://localhost:8081/.well-known/jwks.json\n</code></pre>"},{"location":"superapp-developer/deployment/#phase-4-core-service-deployment","title":"Phase 4: Core Service Deployment","text":"<p>Deploy the main business logic API.</p>"},{"location":"superapp-developer/deployment/#41-prepare-firebase-credentials","title":"4.1 Prepare Firebase Credentials","text":"<p>Copy the Firebase Admin SDK JSON file to your server:</p> <pre><code>sudo mkdir -p /opt/superapp/core\nsudo cp firebase-admin-sdk-xxxxx.json /opt/superapp/core/firebase-admin-sdk.json\nsudo chmod 600 /opt/superapp/core/firebase-admin-sdk.json\n</code></pre>"},{"location":"superapp-developer/deployment/#42-configure-and-deploy","title":"4.2 Configure and Deploy","text":"<p>Follow: backend-core.md - Environment Setup</p> <p>Verify deployment:</p> <pre><code>curl http://localhost:9090/health\n</code></pre>"},{"location":"superapp-developer/deployment/#phase-5-admin-portal-deployment","title":"Phase 5: Admin Portal Deployment","text":"<p>Deploy the web-based management interface.</p>"},{"location":"superapp-developer/deployment/#51-configure-and-deploy","title":"5.1 Configure and Deploy","text":"<p>Follow: Admin Portal README - Getting Started</p> <p>\u26a0\ufe0f Security: Ensure the External IDP (e.g., Asgardeo) is configured with conditional authentication to restrict access to the <code>superapp-admin</code> user group only.</p>"},{"location":"superapp-developer/deployment/#phase-6-mobile-app-build","title":"Phase 6: Mobile App Build","text":"<p>Build and deploy the React Native mobile application.</p>"},{"location":"superapp-developer/deployment/#61-configure-mobile-app","title":"6.1 Configure Mobile App","text":"<p>Follow: mobile-app.md - Project Setup</p>"},{"location":"superapp-developer/deployment/#62-build-mobile-app","title":"6.2 Build Mobile App","text":"<p>For production build:</p> <p>Follow: mobile-app.md - Build Process</p>"},{"location":"superapp-developer/deployment/#post-deployment-checklist","title":"Post-Deployment Checklist","text":"<ul> <li> All services are running and healthy</li> <li> HTTPS/TLS enabled for all public endpoints</li> <li> Database backups configured (automated daily backups recommended)</li> <li> Private keys secured in secrets manager (never stored in code repository)</li> <li> Admin portal access restricted to <code>superapp-admin</code> group via IDP conditional authentication</li> <li> Mobile app can authenticate and load microapps</li> <li> Push notifications working (test with Firebase)</li> <li> Monitoring and logging configured for all services</li> <li> Rate limiting enabled on public endpoints</li> <li> Firewall rules configured to restrict database access</li> </ul>"},{"location":"superapp-developer/deployment/#verification","title":"Verification","text":"<p>Test each service:</p> <pre><code># Token Service - JWKS endpoint\ncurl http://localhost:8081/.well-known/jwks.json\n\n# Core Service - Health check\ncurl http://localhost:9090/health\n\n# Admin Portal - Access in browser\nhttps://admin.yourdomain.com\n\n# Mobile App - Install and test login flow\n</code></pre>"},{"location":"superapp-developer/deployment/#maintenance","title":"Maintenance","text":""},{"location":"superapp-developer/deployment/#key-rotation-every-90-days","title":"Key Rotation (Every 90 days)","text":"<pre><code># Generate new key\ncd backend-services/token-service\n./scripts/generate-keys.sh \"prod-key-$(date +%Y-%m)\" \"./keys/prod\" 4096\n\n# Hot reload (zero-downtime)\ncurl -X POST http://localhost:8081/admin/reload-keys\n\n# Set as active\ncurl -X POST \"http://localhost:8081/admin/active-key?key_id=prod-key-2024-12\"\n</code></pre> <p>\ud83d\udcda Full Key Rotation Guide</p>"},{"location":"superapp-developer/deployment/#troubleshooting","title":"Troubleshooting","text":""},{"location":"superapp-developer/deployment/#common-issues","title":"Common Issues","text":"<p>Token Service JWKS not accessible: - Verify Token Service is running: <code>curl http://&lt;token-service-host&gt;:8081/.well-known/jwks.json</code> - Check firewall rules allow Core Service to access Token Service - Verify key files exist in the configured <code>KEYS_DIR</code></p> <p>Core Service cannot connect to database: - Verify database credentials in environment variables - Check database user has correct privileges: <code>SHOW GRANTS FOR 'coreservice'@'%';</code> - Test connection: <code>mysql -u coreservice -p superapp_production</code></p> <p>Push notifications not working: - Verify Firebase Admin SDK JSON file path is correct - Check Firebase project configuration matches mobile app - Review Firebase console for error logs</p> <p>Mobile app authentication fails: - Verify OAuth2 redirect URI matches exactly in IDP configuration - Check client ID is correct in mobile app environment variables - Review IDP logs for authentication errors</p>"},{"location":"superapp-developer/deployment/#additional-resources","title":"Additional Resources","text":"<ul> <li>Architecture Overview</li> <li>API Reference</li> <li>Observability Setup</li> <li>Microapp Developer Guide</li> </ul>"},{"location":"superapp-developer/mobile-app/","title":"\ud83d\ude80 Super App Mobile (React Native + Expo)","text":"<p>The Mobile App is built with React Native + Expo and TypeScript, serving as a secure container for dynamically loaded MicroApps. It provides OAuth 2.0 authentication via External IdP, token-based authorization, and a WebView bridge for MicroApp-to-native communication.</p>"},{"location":"superapp-developer/mobile-app/#getting-started","title":"Getting Started","text":""},{"location":"superapp-developer/mobile-app/#prerequisites","title":"Prerequisites","text":"<p>Before setting up the project, ensure you have the following installed:</p> <ul> <li>Node.js (v18 or higher)</li> <li>npm  package manager</li> <li>Expo CLI: <code>npm install -g @expo/cli</code></li> <li>Git for version control</li> </ul>"},{"location":"superapp-developer/mobile-app/#project-setup","title":"Project Setup","text":"<ol> <li> <p>Clone the Repository</p> <pre><code>git clone &lt;repository-url&gt;\ncd superapp-mobile/frontend\n</code></pre> </li> <li> <p>Install Dependencies</p> <pre><code>npm install\n</code></pre> </li> <li> <p>Environment Configuration</p> <pre><code>cp .env.example .env\n</code></pre> <p>Fill in the required environment variables in <code>.env</code>:</p> <ul> <li>Authentication <ul> <li>Explicit endpoints (recommended) <ul> <li><code>EXPO_PUBLIC_TOKEN_URL</code></li> <li><code>EXPO_PUBLIC_CLIENT_ID</code></li> <li><code>EXPO_PUBLIC_REDIRECT_URI</code></li> <li><code>EXPO_PUBLIC_LOGOUT_URL</code></li> </ul> </li> </ul> </li> <li>APP Metadata <ul> <li><code>APP_NAME</code></li> <li><code>APP_SLUG</code></li> <li><code>APP_SCHEME</code></li> <li><code>APP_VERSION</code></li> <li><code>APP_OWNER</code></li> <li><code>BUNDLE_IDENTIFIER</code></li> <li><code>ANDROID_PACKAGE</code></li> </ul> </li> <li>Backend <ul> <li><code>BACKEND_BASE_URL</code></li> </ul> </li> <li>Other Services <ul> <li><code>EXPO_PUBLIC_EVENTS_URL</code></li> <li><code>EXPO_PUBLIC_NEWS_URL</code></li> </ul> </li> <li>Optional <ul> <li><code>USE_BACKEND_TOKEN_EXCHANGE</code> (\"true\"|\"false\", default true)</li> <li>OpenTelemetry: set <code>EXPO_PUBLIC_OTEL_ENABLED=true</code> to enable metrics during development and add <code>EXPO_PUBLIC_OTEL_COLLECTOR_URL</code></li> </ul> </li> </ul> <p>Create a folder named <code>google-services</code> inside <code>frontend/</code> and include the Firebase artifacts ( <code>google-services.json</code> and <code>GoogleService-Info.plist</code>) inside it.</p> <p>For branding changes, refer to the <code>assets</code> folder and <code>constant/colors.ts</code>.</p> </li> <li> <p>Start Development Server</p> <pre><code># Android\nnpx expo prebuild --platform android --clean // To pre-build the package\nnpx expo run:android\n\n# iOS Simulator\nnpx expo prebuild --platform ios --clean\nnpx expo run:ios\n</code></pre> </li> </ol>"},{"location":"superapp-developer/mobile-app/#deployment","title":"\ud83d\ude80 Deployment","text":""},{"location":"superapp-developer/mobile-app/#build-process","title":"Build Process","text":"<p>Pre-build Native Projects</p> <pre><code># Android only\nnpx expo prebuild --platform android --clean\n\n# iOS only\nnpx expo prebuild --platform ios --clean\n\n# Both platforms\nnpx expo prebuild --clean\n</code></pre> <p>Android Build</p> <p>Navigate to the Android folder and build:</p> <pre><code>cd android\n./gradlew assembleRelease\n</code></pre> <p>The resulting APK will be in <code>android/app/build/outputs/apk/release/</code>.</p> <p>iOS Build</p> <p>Use either Xcode or command line:</p> <pre><code># Build for archiving\nxcodebuild archive \\\n  -workspace YourAppName.xcworkspace \\\n  -scheme YourSchemeName \\\n  -configuration Release \\\n  -archivePath build/YourAppName.xcarchive\n\n# Export the IPA\nxcodebuild -exportArchive \\\n  -archivePath build/YourAppName.xcarchive \\\n  -exportPath build/ipa \\\n  -exportOptionsPlist ExportOptions.plist\n</code></pre> <p>More Details</p> <ul> <li>Development build</li> <li>Android emulator</li> <li>iOS simulator</li> <li>Expo Go, a limited sandbox for trying out app development with Expo</li> </ul> <p>You can start development by editing the files inside the app directory. This project uses file-based routing.</p> <p>Production Builds Using EAS Build</p> <pre><code># Using EAS Build\nnpx eas build --platform android\nnpx eas build --platform ios\n\n# Or using Expo Application Services\nnpx expo build:android\nnpx expo build:ios\n</code></pre>"},{"location":"superapp-developer/mobile-app/#architecture-overview","title":"\ud83c\udfd7\ufe0f Architecture Overview","text":""},{"location":"superapp-developer/mobile-app/#technology-stack","title":"Technology Stack","text":"<ul> <li>Framework: React Native with Expo (SDK 52+)</li> <li>Language: TypeScript</li> <li>Architecture: MVVM (Model-View-ViewModel)</li> <li>Navigation: Expo Router (file-based routing)</li> <li>State Management: Redux Toolkit + Redux Persist</li> <li>Authentication: OAuth 2.0 / OIDC via External IdP</li> <li>Storage:</li> <li><code>expo-secure-store</code> - Encrypted storage for sensitive data (auth tokens, user configs)</li> <li><code>@react-native-async-storage/async-storage</code> - General storage for non-sensitive data</li> <li>Styling: React Native StyleSheet + Custom components</li> <li>HTTP Client: Axios</li> <li>Testing: Jest + React Native Testing Library</li> <li>E2E Testing: Maestro</li> </ul>"},{"location":"superapp-developer/mobile-app/#security-data-storage","title":"\ud83d\udd12 Security &amp; Data Storage","text":""},{"location":"superapp-developer/mobile-app/#storage-strategy","title":"Storage Strategy","text":"<p>The app uses a dual-storage approach for optimal security and performance:</p> <p>\ud83d\udd10 SecureStore (Encrypted Storage)</p> <ul> <li>Authentication tokens: Access tokens, refresh tokens, ID tokens</li> <li>User configurations: Settings that may contain sensitive preferences</li> <li>Implementation: <code>utils/secureStorage.ts</code> wrapper that automatically routes sensitive keys to <code>expo-secure-store</code></li> </ul> <p>\ud83d\udce6 AsyncStorage (General Storage)</p> <ul> <li>App catalog: Micro-app metadata (names, descriptions, icons)</li> <li>User display info: Read-only user info for UI display (name, email)</li> <li>Cache data: News feed, events (non-sensitive, temporary data)</li> </ul>"},{"location":"superapp-developer/mobile-app/#security-features","title":"Security Features","text":"<ul> <li>Token-based authentication with automatic refresh</li> <li>Encrypted storage for authentication credentials</li> <li>Secure token exchange for micro-app access</li> <li>Automatic token expiration handling</li> <li>Secure logout with complete token cleanup</li> </ul>"},{"location":"superapp-developer/mobile-app/#high-level-mobile-app-flow","title":"High-Level Mobile App Flow","text":"<ol> <li> <p>First launch</p> <ul> <li>If the user is not authenticated, the Login screen is shown.</li> <li>After successful sign-in, the app initializes user profile and configuration.</li> </ul> </li> <li> <p>Landing experience (authenticated)</p> <ul> <li>Default landing tab is Feed.</li> <li>Tabs available: Feed, My Apps, Profile.</li> </ul> </li> <li> <p>Authentication</p> <ul> <li>Retrieve access_token &amp; refresh_token via the IdP and store them in encrypted storage.</li> <li>Fetch user configurations and profile info.</li> <li>Align locally installed micro-apps with server-side configuration (install/uninstall as needed).</li> </ul> </li> <li> <p>Using the app</p> <ul> <li>Feed shows the latest content.</li> <li>My Apps lists the user's micro-apps.</li> <li>Profile provides account details and the sign-out option.</li> </ul> </li> <li> <p>On re-open</p> <ul> <li>If a valid session exists, the app opens directly to the tabs (Feed by default).</li> <li>Checks for a Super App force update; if required, the update screen is shown.</li> <li>Checks if any micro-apps have updates and updates them automatically.</li> </ul> </li> </ol>"},{"location":"superapp-developer/mobile-app/#testing","title":"\ud83e\uddea Testing","text":"<p>This project includes unit and integration tests following industry best practices.</p>"},{"location":"superapp-developer/mobile-app/#running-tests","title":"Running Tests","text":"<pre><code># Run all tests\nnpm test\n\n# Run tests in watch mode\nnpm run test:watch\n\n# Run tests with coverage report\nnpm run test:coverage\n\n# Run tests in CI mode\nnpm run test:ci\n\n# Update test snapshots\nnpm run test:update\n</code></pre>"},{"location":"superapp-developer/mobile-app/#additional-resources","title":"\ud83d\udcda Additional Resources","text":""},{"location":"superapp-developer/mobile-app/#documentation","title":"Documentation","text":"<ul> <li>Expo Documentation</li> <li>React Native Documentation</li> <li>Redux Toolkit Documentation</li> <li>TypeScript Handbook</li> </ul>"},{"location":"superapp-developer/observability/","title":"Observability Stack Deployment","text":"<p>Guide for deploying and configuring the observability stack (OpenTelemetry, Prometheus, Grafana) for monitoring the SuperApp platform.</p>"},{"location":"superapp-developer/observability/#overview","title":"Overview","text":"<p>The observability stack provides:   </p> <ul> <li>OpenTelemetry Collector - Receives and processes telemetry data</li> <li>Prometheus - Time-series metrics storage and querying</li> <li>Grafana - Visualization and dashboards</li> </ul> <p></p>"},{"location":"superapp-developer/observability/#quick-start-development","title":"Quick Start (Development)","text":""},{"location":"superapp-developer/observability/#using-docker-compose","title":"Using Docker Compose","text":"<pre><code>cd observability\ndocker compose up -d\n</code></pre> <p>Access Points:</p> <ul> <li>Prometheus: <code>http://localhost:9090</code></li> <li>Grafana: <code>http://localhost:3000 (admin/admin)</code></li> <li>OpenTelemetry Collector: <code>http://localhost:4318 (OTLP HTTP)</code></li> </ul>"},{"location":"superapp-developer/observability/#production-deployment","title":"Production Deployment","text":""},{"location":"superapp-developer/observability/#prerequisites","title":"Prerequisites","text":"<ul> <li>Docker 20.10+ or Kubernetes cluster</li> <li>Persistent storage for metrics data</li> <li>Network access between services</li> </ul>"},{"location":"superapp-developer/observability/#deployment-options","title":"Deployment Options","text":"<p>Option 1: Docker Compose (Small to Medium Scale)</p> <p>Use the provided <code>docker-compose.yml</code> in the <code>observability/</code> directory:</p> <pre><code>cd observability\ndocker compose up -d\n</code></pre> <p>For production, customize:</p> <ul> <li>Update Grafana admin password in <code>docker-compose.yml</code></li> <li>Configure Prometheus retention period</li> <li>Set up persistent volumes for data</li> <li>Configure alerting rules in <code>prometheus/alerts/</code></li> </ul> <p>Option 2: Kubernetes (Large Scale)</p> <p>Use Prometheus Operator with Helm:</p> <pre><code>kubectl create namespace monitoring\n\nhelm repo add prometheus-community https://prometheus-community.github.io/helm-charts\nhelm install prometheus prometheus-community/kube-prometheus-stack \\\n  --namespace monitoring \\\n  --set prometheus.prometheusSpec.retention=30d\n</code></pre> <p>Deploy OpenTelemetry Collector and configure ServiceMonitor for metrics collection.</p> <p>Access Grafana at <code>http://&lt;grafana-host&gt;:3000</code> Navigate to Dashboards \u2192 Import</p>"},{"location":"superapp-developer/observability/#configuring-services","title":"Configuring Services","text":""},{"location":"superapp-developer/observability/#mobile-app","title":"Mobile App","text":"<p>Update <code>frontend/.env</code>:</p> <pre><code>EXPO_PUBLIC_OTEL_ENABLED=true\nEXPO_PUBLIC_OTEL_COLLECTOR_URL=http://&lt;otel-collector-host&gt;:4318\n\n# Service metadata\n\nEXPO_PUBLIC_OTEL_SERVICE_NAME=superapp-mobile\nEXPO_PUBLIC_OTEL_SERVICE_VERSION=1.0.0\n\nEXPO_PUBLIC_OTEL_API_KEY=your-api-key-here\n\n# Export interval in milliseconds\n# Development: 10000 (10s for fast feedback)\n# Production: 60000-300000 (1-5 minutes to save battery/data)\n\nEXPO_PUBLIC_OTEL_EXPORT_INTERVAL=10000\n\n# Sample rate (0.0 to 1.0)\n# Development: 1.0 (100% of users)\n# Production start: 1.0 (100% of users)\n# Production at scale: 0.1-0.5 (10-50% to reduce costs)\n\nEXPO_PUBLIC_OTEL_SAMPLE_RATE=1.0\n</code></pre>"},{"location":"superapp-developer/observability/#troubleshooting","title":"Troubleshooting","text":""},{"location":"superapp-developer/observability/#metrics-not-appearing","title":"Metrics Not Appearing","text":"<p>Check OTel Collector logs: <pre><code>docker logs otel-collector\n</code></pre></p> <p>Verify endpoint connectivity: <pre><code>curl http://otel-collector:4318/v1/metrics\n</code></pre></p>"},{"location":"superapp-developer/observability/#grafana-not-showing-data","title":"Grafana Not Showing Data","text":"<p>Check Prometheus data source: 1. Navigate to Configuration \u2192 Data Sources 2. Test connection to Prometheus 3. Verify URL: <code>http://prometheus:9090</code></p>"},{"location":"superapp-developer/observability/#high-memory-usage","title":"High Memory Usage","text":"<p>Reduce retention: <pre><code>--storage.tsdb.retention.time=15d\n</code></pre></p> <p>Increase resources: <pre><code>deploy:\n  resources:\n    limits:\n      memory: 4G\n</code></pre></p>"},{"location":"superapp-developer/observability/#security-considerations","title":"Security Considerations","text":""},{"location":"superapp-developer/observability/#1-authentication","title":"1. Authentication","text":"<p>Enable Grafana authentication:</p> <pre><code>GF_AUTH_BASIC_ENABLED=true\nGF_AUTH_ANONYMOUS_ENABLED=false\n</code></pre>"},{"location":"superapp-developer/observability/#2-network-security","title":"2. Network Security","text":"<p>Use firewall rules:</p> <pre><code># Allow only internal network\niptables -A INPUT -p tcp --dport 9090 -s 10.0.0.0/8 -j ACCEPT\niptables -A INPUT -p tcp --dport 9090 -j DROP\n</code></pre>"},{"location":"superapp-developer/observability/#3-tlsssl","title":"3. TLS/SSL","text":"<p>Configure Grafana with TLS:</p> <pre><code>GF_SERVER_PROTOCOL=https\nGF_SERVER_CERT_FILE=/etc/grafana/ssl/cert.pem\nGF_SERVER_CERT_KEY=/etc/grafana/ssl/key.pem\n</code></pre>"},{"location":"superapp-developer/observability/#next-steps","title":"Next Steps","text":"<ul> <li>Deployment Guide - Deploy backend services</li> <li>Admin Portal Guide - Admin monitoring guide</li> <li>Architecture Overview - System architecture</li> </ul>"},{"location":"superapp-developer/pluggable-services/","title":"Pluggable Services Guide","text":"<p>Learn how to create custom implementations of pluggable services in the SuperApp Core Service.</p>"},{"location":"superapp-developer/pluggable-services/#overview","title":"Overview","text":"<p>The SuperApp Core Service uses a pluggable architecture that allows you to swap implementations of key services without changing the core application logic. This enables you to:</p> <ul> <li>Use different storage backends (database, S3, Azure Blob Storage)</li> <li>Integrate with different user management systems</li> <li>Extend functionality without modifying core code</li> </ul>"},{"location":"superapp-developer/pluggable-services/#available-pluggable-services","title":"Available Pluggable Services","text":""},{"location":"superapp-developer/pluggable-services/#1-file-service","title":"1. File Service","text":"<p>Handles file storage and retrieval for microapp packages and user uploads.</p> <p>Interface: <code>fileservice.FileService</code></p> <p>Built-in Implementations: - <code>db</code> - Store files in MySQL database (default)</p> <p>Configuration: <pre><code>FILE_SERVICE_TYPE=db\nFILE_SERVICE_BACKEND_BASE_URL=https://api.superapp.com\n</code></pre></p>"},{"location":"superapp-developer/pluggable-services/#2-user-service","title":"2. User Service","text":"<p>Manages user data and profiles.</p> <p>Interface: <code>userservice.UserService</code></p> <p>Built-in Implementations: - <code>db</code> - Store users in MySQL database (default)</p> <p>Configuration: <pre><code>USER_SERVICE_TYPE=db\n</code></pre></p>"},{"location":"superapp-developer/pluggable-services/#how-pluggable-services-work","title":"How Pluggable Services Work","text":"<p>The pluggable service system uses a registry pattern with these key components:</p> <ol> <li>Interface - Defines the contract (e.g., <code>FileService</code>)</li> <li>Registry - Global registry that stores implementations</li> <li>Registration - Implementations register themselves in <code>init()</code></li> <li>Resolution - Core service retrieves implementation by name</li> </ol>"},{"location":"superapp-developer/pluggable-services/#dynamic-configuration-system","title":"Dynamic Configuration System","text":"<p>The core service automatically passes all environment variables with matching prefixes to your plugin's <code>New()</code> function:</p> <p>For File Service: - Prefix: <code>FILE_SERVICE_</code> - Example: <code>FILE_SERVICE_BACKEND_BASE_URL</code>, <code>FILE_SERVICE_S3_BUCKET_NAME</code></p> <p>For User Service: - Prefix: <code>USER_SERVICE_</code> - Example: <code>USER_SERVICE_API_URL</code>, <code>USER_SERVICE_TIMEOUT</code></p>"},{"location":"superapp-developer/pluggable-services/#creating-plugin-implementations","title":"Creating Plugin Implementations","text":"<p>You can create your plugin implementation outside the main repository as a separate Go module. This is recommended for:</p> <ul> <li>Proprietary implementations</li> <li>Third-party integrations</li> <li>Reusable plugins across projects</li> </ul>"},{"location":"superapp-developer/pluggable-services/#step-by-step-implementing-the-file-service-plugin","title":"Step-by-Step: Implementing the File Service Plugin","text":""},{"location":"superapp-developer/pluggable-services/#1-create-external-module","title":"1. Create External Module","text":"<pre><code># Create your plugin repository\nmkdir superapp-file-service-plugin\ncd superapp-file-service-plugin\ngo mod init github.com/yourorg/superapp-file-service-plugin\n</code></pre>"},{"location":"superapp-developer/pluggable-services/#2-implement-the-plugin","title":"2. Implement the Plugin","text":"<pre><code>// file-service-plugin.go\npackage file_service_plugin\n\n// import the interface from main repo\nimport (\n    fileservice \"go-backend/plugins/file-service\"\n)\n\n// Register your plugin\nfunc init() {\n    fileservice.Registry.Register(\"&lt;your-service-name&gt;\", New)\n}\n\n// This function will be called when the service is initialized\n// It should return an implementation of FileService interface\n// and an error if the initialization fails\nfunc New(config map[string]any) (fileservice.FileService, error) {\n    // config contains:\n    // - FILE_SERVICE_BACKEND_BASE_URL\n    // - FILE_SERVICE_S3_BUCKET_NAME\n    // - FILE_SERVICE_S3_REGION ...\n    // - Any other env vars you define\n\n}\n\n\n// Implement the interface\n\ntype newFileService struct {\n    client *s3.S3\n    otherFields string\n}\n\nfunc (s *newFileService) UploadFile(fileName string, content []byte) (string, error) {\n    ...\n}\n\nfunc (s *newFileService) DeleteFile(fileName string) error {\n    ...\n}\n</code></pre>"},{"location":"superapp-developer/pluggable-services/#3-publish-your-module","title":"3. Publish Your Module","text":"<pre><code>git init\ngit add .\ngit commit -m \"Initial custom file service plugin implementation\"\ngit tag v1.0.0\ngit push origin main --tags\n</code></pre>"},{"location":"superapp-developer/pluggable-services/#4-import-in-main-repo","title":"4. Import in Main Repo","text":"<p>In the main SuperApp repository:</p> <pre><code># Add your external plugin as a dependency\ncd backend-services/core\ngo get github.com/yourorg/superapp-file-service-plugin@v1.0.0\n</code></pre> <p>Update <code>plugins/plugins.go</code>:</p> <pre><code>package plugins\n\nimport (\n    // Default Implementations\n    _ \"go-backend/plugins/file-service/default-db\"\n    _ \"go-backend/plugins/user-service/default-db\"\n\n    // Your custom plugin\n    _ \"github.com/yourorg/superapp-file-service-plugin\"\n)\n</code></pre>"},{"location":"superapp-developer/pluggable-services/#5-configure-and-use","title":"5. Configure and Use","text":"<pre><code># .env\nFILE_SERVICE_TYPE=&lt;your-service-name&gt;\nFILE_SERVICE_YOUR_CUSTOM_ENV_VAR=your-value\nFILE_SERVICE_YOUR_CUSTOM_ENV_VAR_2=your-value\n...\n</code></pre> <p>Important: The blank import (<code>_</code>) ensures the <code>init()</code> function runs and registers your service.</p>"},{"location":"superapp-developer/pluggable-services/#creating-a-custom-user-service","title":"Creating a Custom User Service","text":"<p>Follow the same process as above.</p> <p>See <code>backend-services/core/plugins/</code> for interface definitions.</p> <ul> <li>See <code>backend-services/core/plugins/file-service/default-db</code> for an example implementation.</li> <li>See <code>backend-services/core/plugins/user-service/default-db</code> for an example implementation.</li> </ul>"},{"location":"superapp-developer/pluggable-services/#next-steps","title":"Next Steps","text":"<ul> <li>Core Service Guide - Core service architecture</li> <li>Deployment Guide - Production deployment</li> <li>API Reference - API documentation</li> </ul>"}]}